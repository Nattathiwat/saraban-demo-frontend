import{_ as f}from"./users-duotone-57e3c13d.js";import{_ as v,a as y}from"./line-up-c54e1bbb.js";import{_ as S,r as m,o as w,c as z,a,t as c,h as r,b as d,d as k,f as V,k as x}from"./index-6f9b4dc9.js";const A={name:"group-detail",data(){return{modalAlert:{showModal:!1,title:"",message:""},showLoading:!1,edit:!1,data:{code:"",short_name:"",name:"",subministry_id:"",organization_id:"",department_id:"",desc:""},optionSelect:{subministry_id:[],organization_id:[],department_id:[]}}},methods:{back(){this.$router.push({name:"group",query:{page:this.$route.query.page,perPage:this.$route.query.perPage}}).catch(()=>{})},cancelClick(){this.back(),this.data.desc="",this.data.short_name="",this.data.name=""},onSubmit(){let e=this;this.modalAlert={showModal:!0,type:"confirm",title:`คุณยืนยันการ${this.edit?"แก้ไขกลุ่ม":"สร้างกลุ่ม"}หรือไม่`,confirm:!0,msgSuccess:!0,afterPressAgree(){if(e.edit){let t={desc:e.data.desc,name:e.data.name,short_name:e.data.short_name,subministry_id:e.data.subministry_id,organization_id:e.data.organization_id,department_id:e.data.department_id};e.showLoading=!0,e.axios.put(`group/${e.$route.params.id}`,t).then(()=>{e.showLoading=!1,e.modalAlert={showModal:!0,type:"success",title:"ทำการแก้ไขกลุ่มสำเร็จแล้ว",msgSuccess:!0,afterPressAgree(){e.back()}}}).catch(l=>{e.showLoading=!1,e.modalAlert={showModal:!0,type:"error",title:"Error",message:l.response.data.message}})}else{let t={desc:e.data.desc,name:e.data.name,short_name:e.data.short_name,subministry_id:e.data.subministry_id,organization_id:e.data.organization_id,department_id:e.data.department_id};e.showLoading=!0,e.axios.post("/group",t).then(()=>{e.showLoading=!1,e.modalAlert={showModal:!0,type:"success",title:"ทำการสร้างกลุ่มสำเร็จแล้ว",msgSuccess:!0,afterPressAgree(){e.back()}}}).catch(l=>{e.showLoading=!1,e.modalAlert={showModal:!0,type:"error",title:"Error",message:l.response.data.message}})}}}},apiDetail(){this.showLoading=!0,this.axios.get(`/group/${this.$route.params.id}`).then(e=>{this.showLoading=!1,this.optionSelect.department_id.every(s=>s.id!=e.data.data.department_id)&&this.optionSelect.department_id.push({value:e.data.data.department_id,name:e.data.data.department_name}),this.optionSelect.organization_id.every(s=>s.id!=e.data.data.organization_id)&&this.optionSelect.organization_id.push({value:e.data.data.organization_id,name:e.data.data.organization_name}),this.optionSelect.subministry_id.every(s=>s.id!=e.data.data.subministry_id)&&this.optionSelect.subministry_id.push({value:e.data.data.subministry_id,name:e.data.data.subministry_name}),this.data={...this.data,...e.data.data}}).catch(e=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:e.response.data.message}})},api_master(){this.showLoading=!0;const e=this.axios.get("/organization"),t=this.axios.get("/department"),l=this.axios.get("/subministry");this.axios.all([e,t,l]).then(this.axios.spread((...u)=>{this.showLoading=!1;const s=u[0],n=u[1],p=u[2];s.data.data.filter(i=>(i.value=i.id,i.name=i.name,i)),n.data.data.filter(i=>(i.value=i.id,i.name=i.department_full_name,i)),p.data.data.filter(i=>(i.value=i.id,i.name=i.Name,i)),this.optionSelect.organization_id=s.data.data,this.optionSelect.department_id=n.data.data,this.optionSelect.subministry_id=p.data.data,this.$route.params.id?(this.edit=!0,this.apiDetail()):this.edit=!1})).catch(u=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:u.response.data.message}})},change(e){this.optionSelect.subministry_id.filter(t=>{t.id==e&&(this.optionSelect.organization_id.push({value:t.organization_id,name:t.organization_name}),this.data.organization_id=t.organization_id)}),this.optionSelect.subministry_id.filter(t=>{t.id==e&&(this.optionSelect.department_id.push({value:t.department_id,name:t.department_name}),this.data.department_id=t.department_id)})}},mounted(){this.api_master()}},C={class:"master-group-detail"},L={class:"group-overflow"},q={class:"detail"},M={class:"group-head"},U={class:"group-first"},D={class:"name"},E={class:"group-end"},P={class:"group-detail"},N={class:"group-between"},B={class:"group-input left"},I={class:"group-input"},F={class:"group-between"},O={class:"group-input left"},T={class:"group-input left"},j={class:"group-input"},G={class:"group-between"},H={class:"group-input left"},J={class:"group-footer"},K={class:"footer-left"},Q={class:"footer-right"},R={type:"submit",class:"button-success"};function W(e,t,l,u,s,n){const p=m("cpn-input"),i=m("cpn-autoComplete"),_=m("cpn-textArea"),g=m("Form"),h=m("cpn-modal-alert"),b=m("cpn-loading");return w(),z("div",C,[a("div",L,[a("div",q,[a("div",M,[a("div",U,[t[8]||(t[8]=a("img",{src:f,alt:"",class:"icon-users"},null,-1)),a("div",D,c(s.edit?"แก้ไขกลุ่ม":"สร้างกลุ่ม"),1)]),a("div",E,[a("button",{type:"button",class:"button-back",onClick:t[0]||(t[0]=o=>n.back())},t[9]||(t[9]=[a("img",{src:v,class:"icon-back"},null,-1),a("img",{src:y,class:"icon-line"},null,-1),r(" ย้อนกลับ ")]))])]),t[19]||(t[19]=a("div",{class:"line"},null,-1)),d(g,{onSubmit:n.onSubmit,onInvalidSubmit:e.onInvalidSubmit},{default:k(()=>[a("div",P,[a("div",N,[a("div",B,[t[10]||(t[10]=a("div",{class:"name"},[r("ชื่อย่อกลุ่ม "),a("span",{class:"required"},"*")],-1)),d(p,{modelValue:s.data.short_name,"onUpdate:modelValue":t[1]||(t[1]=o=>s.data.short_name=o),name:"short_name",rules:"required",placeholder:"กรุณาระบุ"},null,8,["modelValue"])]),a("div",I,[t[11]||(t[11]=a("div",{class:"name"},[r("ชื่อกลุ่ม "),a("span",{class:"required"},"*")],-1)),d(p,{modelValue:s.data.name,"onUpdate:modelValue":t[2]||(t[2]=o=>s.data.name=o),name:"name",rules:"required",placeholder:"กรุณาระบุ"},null,8,["modelValue"])])]),a("div",F,[a("div",O,[t[12]||(t[12]=a("div",{class:"name"},[r("กระทรวง "),a("span",{class:"required"},"*")],-1)),d(i,{modelValue:s.data.organization_id,"onUpdate:modelValue":t[3]||(t[3]=o=>s.data.organization_id=o),name:"organization_id",rules:"required",placeholder:"กรุณาระบุ",type:"text",disabled:!0,optionSelect:s.optionSelect.organization_id,onChange:n.change},null,8,["modelValue","optionSelect","onChange"])]),a("div",T,[t[13]||(t[13]=a("div",{class:"name"},[r("หน่วยงาน "),a("span",{class:"required"},"*")],-1)),d(i,{modelValue:s.data.department_id,"onUpdate:modelValue":t[4]||(t[4]=o=>s.data.department_id=o),name:"department_id",rules:"required",placeholder:"กรุณาระบุ",type:"text",disabled:!0,optionSelect:s.optionSelect.department_id,onChange:n.change},null,8,["modelValue","optionSelect","onChange"])]),a("div",j,[t[14]||(t[14]=a("div",{class:"name"},[r("กอง"),a("span",{class:"required"},"*")],-1)),d(i,{modelValue:s.data.subministry_id,"onUpdate:modelValue":t[5]||(t[5]=o=>s.data.subministry_id=o),name:"subministry_id",optionSelect:s.optionSelect.subministry_id,onChange:n.change,prules:"required",placeholder:"กรุณาระบุ",type:"text"},null,8,["modelValue","optionSelect","onChange"])])]),a("div",G,[a("div",H,[t[15]||(t[15]=a("div",{class:"name"},"รายละเอียด",-1)),d(_,{modelValue:s.data.desc,"onUpdate:modelValue":t[6]||(t[6]=o=>s.data.desc=o),name:"group_desc",class:"",style:{},rows:"4",placeholder:"กรุณาระบุ"},null,8,["modelValue"])])])]),t[18]||(t[18]=a("div",{class:"line"},null,-1)),a("div",J,[a("div",K,[a("button",{type:"button",class:"button-danger",onClick:t[7]||(t[7]=o=>n.cancelClick())},t[16]||(t[16]=[a("img",{src:V,alt:"times-circle",class:"icon-times-circle"},null,-1),r(" ยกเลิก ")]))]),a("div",Q,[a("button",R,[t[17]||(t[17]=a("img",{src:x,alt:"times-circle",class:"icon-check-circle"},null,-1)),r(" "+c(s.edit?"ยืนยันแก้ไขกลุ่ม":"ยืนยันสร้างกลุ่ม"),1)])])])]),_:1},8,["onSubmit","onInvalidSubmit"])])]),d(h,{modalAlert:s.modalAlert},null,8,["modalAlert"]),d(b,{show:s.showLoading},null,8,["show"])])}const $=S(A,[["render",W]]);export{$ as default};
