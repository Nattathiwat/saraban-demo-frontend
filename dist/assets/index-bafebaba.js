import{_ as A,r as _,o as d,c as n,a as s,b as r,F as k,h as v,i as h,w as f,v as y,d as q,n as w,t as a,j as p,g as R,k as I}from"./index-d165fd62.js";import{_ as D}from"./ballot-duotone-f2459825.js";import{_ as F}from"./plus-circle-duotone-64bd32fe.js";const j={name:"booking-out-inex",data(){return{modalAlert:{showModal:!1,title:"",message:""},showLoading:!1,optionSelectDefault:{regis_id:[],book_category_id:[]},data:{select:!1,search:"",table:[],page:1,total:0,lastPage:0,perPage:10,tag:"",as_of_date:"",book_category_id:""},modalRegiter:{showModal:!1,booking_register_details:[]}}},methods:{selectedAll(e){e.stopPropagation(),this.data.select=!this.data.select,this.data.table.filter(t=>{t.select=this.data.select})},selected(e,t){e.stopPropagation(),t.select=!t.select,this.data.select=this.data.table.every(m=>m.select)},addClick(){this.$router.push({name:"subministry-work.record-out-create"}).catch(()=>{})},editClick(e){this.$router.push({name:"subministry-work.record-out-edit",params:{id:e.id},query:{page:this.data.page,perPage:this.data.perPage}}).catch(()=>{})},pageChange(e){this.data.perPage=e.perPage,this.data.page=e.page,this.apirecordout()},search(){this.data.status=!0,this.data.perPage=10,this.data.page=1,this.data.tag="",this.apirecordout()},apirecordout(){this.data.table=[],this.showLoading=!0,this.axios.get("/booking-note",{params:{keyword:this.data.search,page_size:this.data.perPage,page:this.data.page,user_id:localStorage.getItem("user_id"),tag:this.data.tag}}).then(e=>{this.showLoading=!1,e.data.data&&(e.data.data.filter(t=>{this.data.total=t.total}),this.data.table=e.data.data,this.data.lastPage=Math.ceil(this.data.total/this.data.perPage))}).catch(e=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:e.response.data.message}})},async on_submit_modal(){let e={book_category_id:parseInt(this.data.book_category_id),user_id:parseInt(localStorage.getItem("user_id")),as_of_date:this.data.as_of_date};this.showLoading=!0,this.axios.post("/booking-note/quick",e).then(()=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"success",title:"สร้างบันทึกข้อความสำเร็จแล้ว",msgSuccess:!0,afterPressAgree(){location.reload()}}}).catch(t=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:t.response.data.message}}),this.modalRegiter.showModal=!1},modal_genno(){this.modalRegiter.showModal=!0,this.modalRegiter.booking_register_details=[{}]},api_master(){this.showLoading=!0;const e=this.axios.get("/master-data/book-category",{params:{book_type:1}});this.axios.all([e]).then(this.axios.spread((...t)=>{this.showLoading=!1;const m=t[0];m.data.data.filter(g=>(g.value=g.id,g.name=g.name,g)),this.optionSelectDefault.book_category_id=m.data.data,this.apirecordout()})).catch(t=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:t.response.data.message}})}},mounted(){var e,t;this.data.page=((e=this.$route.query)==null?void 0:e.page)||this.data.page,this.data.perPage=((t=this.$route.query)==null?void 0:t.perPage)||this.data.perPage,this.api_master()}},z={class:"record-out-inex"},E={class:"group-overflow"},N={class:"detail"},B={class:"group-head"},U={class:"group-first"},T=s("img",{src:D,alt:"",class:"icon-users-cog"},null,-1),G=s("div",{class:"name"},"บันทึกส่งออก",-1),H=s("div",{class:"group-image"},[s("img",{src:F,alt:"",class:"icon-plus"}),p(" สร้างบันทึกส่งออก ")],-1),J=[H],K={class:"d-flex justify-content-end"},O={class:"group-end"},Q={class:"search"},W=s("div",{class:"line"},null,-1),X={class:"group-body"},Y={class:"table-booking-out-inex"},Z={class:"thead"},$={class:"thead-row"},ss={class:"col0"},ts=s("i",{class:"bi bi-plus-lg"},null,-1),os=[ts],es=s("th",{class:"col1"},"ความเร่งด่วน",-1),as=s("th",{class:"col2"},"เลขบันทึกภายใน",-1),ls=s("th",{class:"col3"},"ชื่อเรื่อง",-1),is=s("th",{class:"col4"},"หน่วยงานปลายทาง",-1),ds=s("th",{class:"col5"},"ลงวันที่",-1),ns=s("th",{class:"col6"},"ชนิด",-1),cs=s("th",{class:"col7"},"ผู้รับผิดชอบ",-1),_s=s("th",{class:"col8"},"สถานะ",-1),rs={class:"tbody"},hs=["onClick"],gs=["onClick"],us={key:0},ps=s("i",{class:"bi bi-dash-lg"},null,-1),ms=[ps],bs={key:1},ks=s("i",{class:"bi bi-plus-lg"},null,-1),vs=[ks],fs={class:"col1"},ys={class:"col2"},ws={class:"col3"},Ps={class:"col4"},Cs={class:"col5"},Ss={class:"col6"},Vs={class:"col7"},xs={class:"group-show"},Ls={class:"span"},Ms={class:"show-detail"},As={class:"col8"},qs={class:"col0"},Rs={class:"col1"},Is={class:"col2"},Ds={class:"group-show date"},Fs={class:"span"},js={class:"show-detail date"},zs={class:"col3"},Es={class:"col4"},Ns={class:"col5"},Bs={class:"col6"},Us={class:"col7"},Ts={class:"group-show"},Gs={class:"span"},Hs={class:"show-detail"},Js={class:"col8"},Ks={key:1},Os=s("td",{colspan:"9",style:{"border-bottom":"solid 1px #c1cfe3"}},null,-1),Qs=[Os],Ws={key:0,class:"tbody-row"},Xs=s("td",{colspan:"9"},"ไม่มีข้อมูล",-1),Ys=[Xs],Zs={class:"group-footer"},$s={class:"modal-register"},st={class:"modal-class"},tt={class:"modal-center"},ot={class:"modal-size",ref:"modalRegiterref"},et={class:"modal-title"},at=s("div",{class:"title-size"},"ออกเลขบันทึกภายใน",-1),lt=s("div",{class:"line"},null,-1),it={class:"modal-detail"},dt={class:"detail-sub"},nt={class:"group-between"},ct={class:"group-input"},_t=s("div",{class:"name"},[p("ทะเบียนบันทึกข้อความ "),s("span",{class:"required"},"*")],-1),rt={class:"group-between"},ht={class:"group-input"},gt=s("div",{class:"name"},[p("ลงวันที่ "),s("span",{class:"required"},"*")],-1),ut=s("div",{class:"line"},null,-1),pt={class:"group-footer"},mt=s("div",{class:"group-name"},[s("img",{src:R,alt:"times-circle",class:"image-icon"}),s("div",{class:"name"},"ยกเลิก")],-1),bt=[mt],kt=s("div",{class:"group-name"},[s("img",{src:I,alt:"times-circle",class:"image-icon"}),s("div",{class:"name"},"ตกลง")],-1),vt=[kt];function ft(e,t,m,g,l,c){const P=_("cpn-input"),C=_("cpn-pagination"),S=_("cpn-select"),V=_("cpn-datepicker"),x=_("Form"),L=_("cpn-modal-alert"),M=_("cpn-loading");return d(),n("div",z,[s("div",E,[s("div",N,[s("div",B,[s("div",U,[T,G,s("button",{type:"button",class:"add-booking-out",onClick:t[0]||(t[0]=o=>c.addClick())},J),s("div",K,[s("button",{type:"button",class:"add-booking-out",onClick:t[1]||(t[1]=o=>c.modal_genno())}," ออกเลขบันทึกภายใน ")])]),s("div",O,[s("div",Q,[r(P,{modelValue:l.data.search,"onUpdate:modelValue":t[2]||(t[2]=o=>l.data.search=o),name:"search",type:"text",searchFlag:!0,onSearchClick:t[3]||(t[3]=o=>c.search()),placeholder:"เลขที่หนังสือออก/ชื่อเรื่อง/Tag"},null,8,["modelValue"])])])]),W,s("div",X,[s("table",Y,[s("thead",Z,[s("tr",$,[s("th",ss,[s("button",{onClick:t[4]||(t[4]=o=>c.selectedAll(o))},os)]),es,as,ls,is,ds,ns,cs,_s])]),s("tbody",rs,[(d(!0),n(k,null,v(l.data.table,(o,u)=>(d(),n(k,{key:u},[s("tr",{class:w(["tbody-row pointer",u%2!=0?"color-tr1":"color-tr2"]),onClick:i=>c.editClick(o)},[s("td",{class:"col0",onClick:i=>o.booking_follows.length>1?c.selected(i,o):""},[o.select&&o.booking_follows.length>1?(d(),n("button",us,ms)):h("",!0),!o.select&&o.booking_follows.length>1?(d(),n("button",bs,vs)):h("",!0)],8,gs),s("td",fs,a(o.speed_name),1),s("td",ys,a(o.booking_note_number),1),s("td",ws,a(o.subject),1),s("td",Ps,a(o.booking_follows.length>1?o.booking_follows.length:o.department_name),1),s("td",Cs,a(o.as_of_date),1),s("td",Ss,a(o.book_type),1),s("td",Vs,[s("div",xs,[s("span",Ls,a(o.response_name),1),s("div",Ms,[p(a(o.response_name)+" ",1),h("",!0)])])]),s("td",As,a(o.status_name),1)],10,hs),o.select&&o.booking_follows.length>1?(d(!0),n(k,{key:0},v(o.booking_follows,(i,b)=>(d(),n("tr",{key:b,class:w(["tbody-row",u%2!=0?b%2!=0?"color-tr1":"color-tr2":b%2!=0?"color-tr2":"color-tr1"])},[s("td",qs,a(),1),s("td",Rs,a(b+1),1),s("td",Is,[p(a()+" ",1),s("div",Ds,[s("span",Fs,a(i.department_name),1),s("div",js,"วันที่ส่งออก: "+a(i.created_at),1)])]),s("td",zs,a(i.subject),1),s("td",Es,a(),1),s("td",Ns,a(i.as_of_date),1),s("td",Bs,a(i.book_type),1),s("td",Us,[s("div",Ts,[s("span",Gs,a(i.creater_name),1),s("div",Hs,[p(a(i.creater_name)+" ",1),h("",!0)])])]),s("td",Js,a(i.status_name),1)],2))),128)):h("",!0),o.select&&o.booking_follows.length>1?(d(),n("tr",Ks,Qs)):h("",!0)],64))),128)),l.data.table.length==0?(d(),n("tr",Ws,Ys)):h("",!0)])])]),s("div",Zs,[r(C,{page:l.data.page,total:l.data.total,lastPage:l.data.lastPage,perPage:l.data.perPage,onPageChange:c.pageChange},null,8,["page","total","lastPage","perPage","onPageChange"])])])]),f(s("div",$s,[s("div",st,[s("div",tt,[s("div",ot,[r(x,{onSubmit:c.on_submit_modal,onInvalidSubmit:e.onInvalidSubmit},{default:q(()=>[s("div",et,[at,s("i",{class:"bi bi-x-lg icon-close",onClick:t[5]||(t[5]=o=>l.modalRegiter.showModal=!1)})]),lt,s("div",it,[(d(!0),n(k,null,v(l.modalRegiter.booking_register_details,(o,u)=>(d(),n("div",{class:"message",key:u},[s("div",dt,[s("div",nt,[s("div",ct,[_t,r(S,{modelValue:l.data.book_category_id,"onUpdate:modelValue":t[6]||(t[6]=i=>l.data.book_category_id=i),name:"book_category_id",rules:"required",optionSelect:l.optionSelectDefault.book_category_id},null,8,["modelValue","optionSelect"])])]),s("div",rt,[s("div",ht,[gt,r(V,{modelValue:l.data.as_of_date,"onUpdate:modelValue":t[7]||(t[7]=i=>l.data.as_of_date=i),rules:"required",name:`addregis_date${u}`},null,8,["modelValue","name"])])])])]))),128))]),ut,s("div",pt,[s("button",{type:"button",onClick:t[8]||(t[8]=o=>l.modalRegiter.showModal=!1),class:"btn button-danger"},bt),f(s("button",{type:"submit",class:"btn button-success",onClick:t[9]||(t[9]=o=>e.flagSave=3)},vt,512),[[y,!l.data.booking_note_number]])])]),_:1},8,["onSubmit","onInvalidSubmit"])],512)])])],512),[[y,l.modalRegiter.showModal]]),r(L,{modalAlert:l.modalAlert},null,8,["modalAlert"]),r(M,{show:l.showLoading},null,8,["show"])])}const Ct=A(j,[["render",ft]]);export{Ct as default};
