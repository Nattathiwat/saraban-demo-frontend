import{_ as y,l as V,r as m,o as u,c,a as t,t as p,j as l,b as i,d as S,i as _,n as h,w as v,v as g,g as A,k as C}from"./index-a1f916c1.js";import{_ as L,a as q,b as x}from"./line-up-de17f46c.js";import{_ as M}from"./user-crown-duotone-33e2faac.js";const U="/assets/crown-duotone-7e0b0b0a.svg",D="/assets/user-crown-duotoneffffff-4bec3f43.svg";const E={name:"user-detail",data(){return{modalAlert:{showModal:!1,title:"",message:""},showLoading:!1,edit:!1,data:{fname:"",lname:"",username:"",password:"",email:"",department_id:"",level:2,birthdate:"",optionSelect:{department:[{name:"สำนักงานเลขาธิการ",value:"สำนักงานเลขาธิการ"}]}}}},components:{date:V},methods:{keyupDepartment(e){this.data.optionSelect.department=[],this.axios.get("/master-data/department",{params:{keyword:e.target.value}}).then(a=>{a.data.data&&(a.data.data.filter(d=>(d.value=d.id,d.name=d.department_full_name,d)),this.data.optionSelect.department=a.data.data)})},levelClick(e){this.data.level=e},back(){this.$router.push({name:"user"}).catch(()=>{})},cancelClick(){this.back(),this.data.username="",this.data.password="",this.data.email="",this.data.department_id="",this.data.level=2,this.data.birthdate=""},onSubmit(){let e=this;this.modalAlert={showModal:!0,type:"confirm",title:`คุณยืนยันการ${this.edit?"แก้ไขผู้ใช้งาน":"สร้างผู้ใช้งาน"}หรือไม่`,confirm:!0,msgSuccess:!0,afterPressAgree(){if(e.edit){let a={fname:e.data.fname,lname:e.data.lname,email:e.data.email,department_id:parseInt(e.data.department_id),username:e.data.username,password:e.data.password,role_id:e.data.level,birthdate:e.data.birthdate};e.showLoading=!0,e.axios.put(`/user/${e.$route.params.id}`,a).then(()=>{e.showLoading=!1,e.modalAlert={showModal:!0,type:"success",title:"ทำการแก้ไขผู้ใช้งานสำเร็จแล้ว",msgSuccess:!0,afterPressAgree(){e.back()}}}).catch(d=>{e.showLoading=!1,e.modalAlert={showModal:!0,type:"error",title:"Error",message:d.response.data.message}})}else{let a={fname:e.data.fname,lname:e.data.lname,email:e.data.email,department_id:parseInt(e.data.department_id),username:e.data.username,password:e.data.password,role_id:e.data.level,birthdate:e.data.birthdate};e.showLoading=!0,e.axios.post("/user",a).then(()=>{e.showLoading=!1,e.modalAlert={showModal:!0,type:"success",title:"ทำการสร้างผู้ใช้งานสำเร็จแล้ว",msgSuccess:!0,afterPressAgree(){e.back()}}}).catch(d=>{e.showLoading=!1,e.modalAlert={showModal:!0,type:"error",title:"Error",message:d.response.data.message}})}}}},apiDetail(){this.showLoading=!0,this.axios.get(`/user/${this.$route.params.id}`).then(e=>{this.showLoading=!1,this.data.fname=e.data.data.fname,this.data.lname=e.data.data.lname,this.data.username=e.data.data.username,this.data.password=e.data.data.password,this.data.email=e.data.data.email,this.data.department_id=e.data.data.department_id,this.data.birthdate=e.data.data.birthdate,this.data.level=e.data.data.role_id}).catch(e=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:e.response.data.message}})},apiMaster(){this.showLoading=!0,this.axios.get("/master-data/department").then(e=>{this.showLoading=!1,e.data.data.filter(a=>(a.value=a.id,a.name=a.department_full_name,a)),this.data.optionSelect.department=e.data.data,this.$route.params.id?(this.edit=!0,this.apiDetail()):this.edit=!1}).catch(e=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:e.response.data.message}})}},mounted(){this.apiMaster()}},I={class:"user-detail"},N={class:"group-overflow"},B={class:"detail"},P={class:"group-head"},F={class:"group-first"},j=t("img",{src:L,alt:"",class:"icon-users"},null,-1),z={class:"name"},K={class:"group-end"},T=t("img",{src:q,class:"icon-back"},null,-1),G=t("img",{src:x,class:"icon-line"},null,-1),H=t("div",{class:"line"},null,-1),J={class:"group-detail"},O={class:"group-between"},Q={class:"group-input left"},R=t("div",{class:"name"},[l("ชื่อ"),t("span",{class:"required"},"*")],-1),W={class:"group-input"},X=t("div",{class:"name"},[l("นามสกุล"),t("span",{class:"required"},"*")],-1),Y={class:"group-between"},Z={class:"group-input left"},$={class:"name"},ee={key:0,class:"required"},te={class:"group-input"},ae={class:"name"},se={key:0,class:"required"},oe={class:"group-between"},le={class:"group-input left"},de=t("div",{class:"name"},[l("Email "),t("span",{class:"required"},"*")],-1),ie={class:"group-input"},ne=t("div",{class:"name"},[l("หน่วยงาน "),t("span",{class:"required"},"*")],-1),re={class:"group-level"},me=t("div",{class:"level-first"},[t("img",{src:U,alt:"",class:"icon-crown"}),t("div",{class:"name"},[l("สิทธิ์ "),t("span",{class:"required"},"*")])],-1),ue={class:"level-button"},ce={class:"group-user"},pe={src:D,alt:"",class:"icon-user-crown"},_e={src:M,alt:"",class:"icon-user-crown"},he=t("div",{class:"line"},null,-1),ve={class:"group-footer"},ge={class:"footer-left"},fe=t("img",{src:A,alt:"times-circle",class:"icon-times-circle"},null,-1),be={class:"footer-right"},we={type:"submit",class:"button-success"},ke=t("img",{src:C,alt:"times-circle",class:"icon-check-circle"},null,-1);function ye(e,a,d,Ve,s,n){const r=m("cpn-input"),f=m("cpn-autoComplete"),b=m("Form"),w=m("cpn-modal-alert"),k=m("cpn-loading");return u(),c("div",I,[t("div",N,[t("div",B,[t("div",P,[t("div",F,[j,t("div",z,p(s.edit?"แก้ไขผู้ใช้งาน":"สร้างผู้ใช้งาน"),1)]),t("div",K,[t("button",{type:"button",class:"button-back",onClick:a[0]||(a[0]=o=>n.back())},[T,G,l(" ย้อนกลับ ")])])]),H,i(b,{onSubmit:n.onSubmit,onInvalidSubmit:e.onInvalidSubmit},{default:S(()=>[t("div",J,[t("div",O,[t("div",Q,[R,i(r,{modelValue:s.data.fname,"onUpdate:modelValue":a[1]||(a[1]=o=>s.data.fname=o),name:"fname",rules:"required",placeholder:"กรุณาระบุ"},null,8,["modelValue"])]),t("div",W,[X,i(r,{modelValue:s.data.lname,"onUpdate:modelValue":a[2]||(a[2]=o=>s.data.lname=o),name:"lname",rules:"required",placeholder:"กรุณาระบุ"},null,8,["modelValue"])])]),t("div",Y,[t("div",Z,[t("div",$,[l("ชื่อผู้ใช้งาน "),s.edit?_("",!0):(u(),c("span",ee,"*"))]),i(r,{modelValue:s.data.username,"onUpdate:modelValue":a[3]||(a[3]=o=>s.data.username=o),name:"Usern",rules:s.edit?"":"required",disabled:s.edit,placeholder:"กรุณาระบุ"},null,8,["modelValue","rules","disabled"])]),t("div",te,[t("div",ae,[l("รหัสผ่าน "),s.edit?_("",!0):(u(),c("span",se,"*"))]),i(r,{modelValue:s.data.password,"onUpdate:modelValue":a[4]||(a[4]=o=>s.data.password=o),name:"passw",type:"password",rules:s.edit?"":"required",disabled:s.edit,placeholder:"กรุณาระบุ"},null,8,["modelValue","rules","disabled"])])]),t("div",oe,[t("div",le,[de,i(r,{modelValue:s.data.email,"onUpdate:modelValue":a[5]||(a[5]=o=>s.data.email=o),name:"email",rules:"required|email",placeholder:"กรุณาระบุ"},null,8,["modelValue"])]),t("div",ie,[ne,i(f,{modelValue:s.data.department_id,"onUpdate:modelValue":a[6]||(a[6]=o=>s.data.department_id=o),name:"department",placeholder:"กรุณาระบุ",rules:"required",onKeyup:a[7]||(a[7]=o=>n.keyupDepartment(o)),optionSelect:s.data.optionSelect.department},null,8,["modelValue","optionSelect"])])])]),t("div",re,[me,t("div",ue,[t("button",{type:"button",class:h(["button-admin",s.data.level==1?"active":""]),onClick:a[8]||(a[8]=o=>n.levelClick(1))},[t("div",ce,[v(t("img",pe,null,512),[[g,s.data.level==1]]),v(t("img",_e,null,512),[[g,s.data.level!=1]]),l(" User Admin ")])],2),t("button",{type:"button",class:h(["button-user",s.data.level==2?"active":""]),onClick:a[9]||(a[9]=o=>n.levelClick(2))}," User ",2)])]),he,t("div",ve,[t("div",ge,[t("button",{type:"button",class:"button-danger",onClick:a[10]||(a[10]=o=>n.cancelClick())},[fe,l(" ยกเลิก ")])]),t("div",be,[t("button",we,[ke,l(" "+p(s.edit?"ยืนยันแก้ไขผู้ใช้งาน":"ยืนยันสร้างผู้ใช้งาน"),1)])])])]),_:1},8,["onSubmit","onInvalidSubmit"])])]),i(w,{modalAlert:s.modalAlert},null,8,["modalAlert"]),i(k,{show:s.showLoading},null,8,["show"])])}const Le=y(E,[["render",ye]]);export{Le as default};
