import{_ as P,r as p,o as n,c as d,a as s,h as C,b as h,F as b,i as k,j as c,n as m,t as a,w as x,v as A}from"./index-6f9b4dc9.js";import{_ as V}from"./ballot-duotone-f2459825.js";import{_ as L}from"./plus-circle-duotone-64bd32fe.js";const S={name:"booking-out-inex",data(){return{modalAlert:{showModal:!1,title:"",message:""},showLoading:!1,data:{select:!1,search:"",table:[],page:1,total:0,lastPage:0,perPage:10,tag:""}}},methods:{creater_name(o){let t="";return o.filter(g=>{t+=g.response_name+", "}),t.slice(0,-2)},selectedAll(o){o.stopPropagation(),this.data.select=!this.data.select,this.data.table.filter(t=>{t.select=this.data.select})},selected(o,t){o.stopPropagation(),t.select=!t.select,this.data.select=this.data.table.every(g=>g.select)},addClick(){this.$router.push({name:"subministry-work.booking-out-create"}).catch(()=>{})},editClick(o){this.$router.push({name:"subministry-work.booking-out-edit",params:{id:o.id},query:{page:this.data.page,perPage:this.data.perPage}}).catch(()=>{})},pageChange(o){this.data.perPage=o.perPage,this.data.page=o.page,this.apigetexport()},search(){this.data.status=!0,this.data.perPage=10,this.data.page=1,this.data.tag="",this.apigetexport()},apigetexport(){this.data.table=[],this.showLoading=!0,this.axios.get("/booking-out",{params:{keyword:this.data.search,page_size:this.data.perPage,page:this.data.page,user_id:localStorage.getItem("user_id"),tag:this.data.tag,flag:"subministry"}}).then(o=>{this.showLoading=!1,o.data.data&&(o.data.data.filter(t=>{this.data.total=t.total}),this.data.table=o.data.data,this.data.lastPage=Math.ceil(this.data.total/this.data.perPage))}).catch(o=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:o.response.data.message}})},deleteClick(o){let t=this;this.modalAlert={showModal:!0,type:"confirm",title:"คุณยืนยันการลบหนังสือส่งออก",message:`“${o.name}” ใช่หรือไม่`,confirm:!0,msgSuccess:!0,afterPressAgree(){t.modalAlert={showModal:!0,type:"success",title:"ทำการลบหนังสือส่งออกสำเร็จแล้ว",msgSuccess:!0,afterPressAgree(){t.apigetexport()}}}}}},mounted(){var o,t;this.data.page=((o=this.$route.query)==null?void 0:o.page)||this.data.page,this.data.perPage=((t=this.$route.query)==null?void 0:t.perPage)||this.data.perPage,this.apigetexport()}},M={class:"booking-out-inex"},N={class:"group-overflow"},j={class:"detail"},q={class:"group-head"},B={class:"group-first"},F={class:"group-end"},z={class:"search"},D={class:"group-body"},E={class:"table-booking-out-inex"},T={class:"thead"},I={class:"thead-row"},U={class:"col0"},G={class:"tbody"},H=["onClick"],J=["onClick"],K={key:0},O={key:1},Q={class:"col1"},R={class:"col2"},W={class:"col3"},X={class:"col4"},Y={class:"col5"},Z={class:"col6"},$={class:"col7"},tt={class:"group-show"},st={class:"span"},et={class:"col8"},ot={class:"col0"},at={class:"col1"},lt={class:"col2"},rt={class:"col3"},nt={class:"col4"},dt={class:"col5"},it={class:"col6"},ct={class:"col7"},gt={class:"group-show"},_t={class:"span"},pt={class:"show-detail"},ht={class:"col8"},ut={key:1},bt={key:0,class:"tbody-row"},kt={class:"group-footer"};function mt(o,t,g,yt,r,i){const y=p("cpn-input"),f=p("cpn-pagination"),w=p("cpn-modal-alert"),v=p("cpn-loading");return n(),d("div",M,[s("div",N,[s("div",j,[s("div",q,[s("div",B,[t[5]||(t[5]=s("img",{src:V,alt:"",class:"icon-users-cog"},null,-1)),t[6]||(t[6]=s("div",{class:"name"},"หนังสือส่งออก",-1)),s("button",{type:"button",class:"add-booking-out",onClick:t[0]||(t[0]=e=>i.addClick())},t[4]||(t[4]=[s("div",{class:"group-image"},[s("img",{src:L,alt:"",class:"icon-plus"}),C(" สร้างหนังสือส่งออก ")],-1)]))]),s("div",F,[s("div",z,[h(y,{modelValue:r.data.search,"onUpdate:modelValue":t[1]||(t[1]=e=>r.data.search=e),name:"search",type:"text",searchFlag:!0,onSearchClick:t[2]||(t[2]=e=>i.search()),placeholder:"เลขที่หนังสือออก/ชื่อเรื่อง/Tag"},null,8,["modelValue"])])])]),t[20]||(t[20]=s("div",{class:"line"},null,-1)),s("div",D,[s("table",E,[s("thead",T,[s("tr",I,[s("th",U,[s("button",{onClick:t[3]||(t[3]=e=>i.selectedAll(e))},t[7]||(t[7]=[s("i",{class:"bi bi-plus-lg"},null,-1)]))]),t[8]||(t[8]=s("th",{class:"col1"},"ความเร่งด่วน",-1)),t[9]||(t[9]=s("th",{class:"col2"},"เลขที่หนังสือออก",-1)),t[10]||(t[10]=s("th",{class:"col3"},"ชื่อเรื่อง",-1)),t[11]||(t[11]=s("th",{class:"col4"},"หน่วยงานปลายทาง",-1)),t[12]||(t[12]=s("th",{class:"col5"},"ลงวันที่",-1)),t[13]||(t[13]=s("th",{class:"col6"},"ชนิด",-1)),t[14]||(t[14]=s("th",{class:"col7"},"ผู้รับผิดชอบ",-1)),t[15]||(t[15]=s("th",{class:"col8"},"สถานะ",-1))])]),s("tbody",G,[(n(!0),d(b,null,k(r.data.table,(e,u)=>(n(),d(b,{key:u},[s("tr",{class:m(["tbody-row pointer",u%2!=0?"color-tr1":"color-tr2"]),onClick:l=>i.editClick(e)},[s("td",{class:"col0",onClick:l=>e.register_count>1?i.selected(l,e):""},[e.select&&e.register_count>1?(n(),d("button",K,t[16]||(t[16]=[s("i",{class:"bi bi-dash-lg"},null,-1)]))):c("",!0),!e.select&&e.register_count>1?(n(),d("button",O,t[17]||(t[17]=[s("i",{class:"bi bi-plus-lg"},null,-1)]))):c("",!0)],8,J),s("td",Q,a(e.speed_name),1),s("td",R,a(e.book_out_num),1),s("td",W,a(e.subject),1),s("td",X,a(e.register_count>1?e.register_count:e.department_name),1),s("td",Y,a(e.regis_date),1),s("td",Z,a(e.book_type),1),s("td",$,[s("div",tt,[s("span",st,a(e.booking_follows.length>0?e.booking_follows[0].response_name+"...":""),1),x(s("div",{class:"show-detail"},a(i.creater_name(e.booking_follows)),513),[[A,e.booking_follows.length>0]])])]),s("td",et,a(e.status_name),1)],10,H),e.select&&e.register_count>1?(n(!0),d(b,{key:0},k(e.booking_registers,(l,_)=>(n(),d("tr",{key:_,class:m(["tbody-row",u%2!=0?_%2!=0?"color-tr1":"color-tr2":_%2!=0?"color-tr2":"color-tr1"])},[s("td",ot,a(),1),s("td",at,a(_+1),1),s("td",lt,a(l.book_out_num),1),s("td",rt,a(l.subject),1),s("td",nt,a(l.department_name),1),s("td",dt,a(l.regis_date),1),s("td",it,a(l.book_type),1),s("td",ct,[s("div",gt,[s("span",_t,a(l.creater_name),1),s("div",pt,a(l.creater_name),1)])]),s("td",ht,a(l.status_name),1)],2))),128)):c("",!0),e.select&&e.register_count>1?(n(),d("tr",ut,t[18]||(t[18]=[s("td",{colspan:"9",style:{"border-bottom":"solid 1px #c1cfe3"}},null,-1)]))):c("",!0)],64))),128)),r.data.table.length==0?(n(),d("tr",bt,t[19]||(t[19]=[s("td",{colspan:"9"},"ไม่มีข้อมูล",-1)]))):c("",!0)])])]),s("div",kt,[h(f,{page:r.data.page,total:r.data.total,lastPage:r.data.lastPage,perPage:r.data.perPage,onPageChange:i.pageChange},null,8,["page","total","lastPage","perPage","onPageChange"])])])]),h(w,{modalAlert:r.modalAlert},null,8,["modalAlert"]),h(v,{show:r.showLoading},null,8,["show"])])}const Pt=P(S,[["render",mt]]);export{Pt as default};
