import{_ as b}from"./users-duotone-57e3c13d.js";import{_ as w,a as y}from"./line-up-c54e1bbb.js";import{_ as S,r as u,o as V,c as k,a,t as c,h as l,b as n,d as z,f as x,k as A}from"./index-6f9b4dc9.js";const q={name:"subministry-detail",data(){return{modalAlert:{showModal:!1,title:"",message:""},showLoading:!1,edit:!1,data:{code:"",short_name:"",Name:"",desc:"",active_flag:!0,organization_id:"",department_id:""},optionSelect:{organization_id:[],department_id:[]}}},methods:{back(){this.$router.push({name:"subministry",query:{page:this.$route.query.page,perPage:this.$route.query.perPage}}).catch(()=>{})},cancelClick(){this.back(),this.data.code="",this.data.short_name="",this.data.Name=""},onSubmit(){let t=this;this.modalAlert={showModal:!0,type:"confirm",title:`คุณยืนยันการ${this.edit?"แก้ไขกอง":"สร้างกอง"}หรือไม่`,confirm:!0,msgSuccess:!0,afterPressAgree(){if(t.edit){let e={code:t.data.code,Name:t.data.Name,short_name:t.data.short_name,desc:t.data.desc,department_id:t.data.department_id,active_flag:t.data.active_flag?1:0};t.showLoading=!0,t.axios.put(`/subministry/${t.$route.params.id}`,e).then(()=>{t.showLoading=!1,t.modalAlert={showModal:!0,type:"success",title:"ทำการแก้ไขกองสำเร็จแล้ว",msgSuccess:!0,afterPressAgree(){t.back()}}}).catch(i=>{t.showLoading=!1,t.modalAlert={showModal:!0,type:"error",title:"Error",message:i.response.data.message}})}else{let e={code:t.data.code,Name:t.data.Name,short_name:t.data.short_name,desc:t.data.desc,department_id:t.data.department_id,active_flag:t.data.active_flag?1:0};t.showLoading=!0,t.axios.post("/subministry",e).then(()=>{t.showLoading=!1,t.modalAlert={showModal:!0,type:"success",title:"ทำการสร้างกองสำเร็จแล้ว",msgSuccess:!0,afterPressAgree(){t.back()}}}).catch(i=>{t.showLoading=!1,t.modalAlert={showModal:!0,type:"error",title:"Error",message:i.response.data.message}})}}}},apiDetail(){this.showLoading=!0,this.axios.get(`/subministry/${this.$route.params.id}`).then(t=>{this.showLoading=!1,this.optionSelect.department_id.every(r=>r.id!=t.data.data.department_id)&&this.optionSelect.department_id.push({value:t.data.data.department_id,name:t.data.data.department_name}),this.optionSelect.organization_id.every(r=>r.id!=t.data.data.organization_id)&&this.optionSelect.organization_id.push({value:t.data.data.organization_id,name:t.data.data.organization_name}),this.data={...this.data,...t.data.data},this.data.active_flag=t.data.data.active_flag==1}).catch(t=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:t.response.data.message}})},api_master(){this.showLoading=!0;const t=this.axios.get("/master-data/organization"),e=this.axios.get("/department");this.axios.all([t,e]).then(this.axios.spread((...i)=>{this.showLoading=!1;const r=i[0],s=i[1];r.data.data.filter(o=>(o.value=o.id,o.name=o.name,o)),s.data.data.filter(o=>(o.value=o.id,o.name=o.department_full_name,o)),this.optionSelect.organization_id=r.data.data,this.optionSelect.department_id=s.data.data,this.$route.params.id?(this.edit=!0,this.apiDetail()):this.edit=!1})).catch(i=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:i.response.data.message}})},change(t){this.optionSelect.department_id.filter(e=>{e.id==t&&(this.optionSelect.organization_id.push({value:e.organization_id,name:e.organization_name}),this.data.organization_id=e.organization_id)})},keyup_dep(t){this.axios.get("/department",{params:{keyword:t.target.value}}).then(e=>{e.data.data&&(e.data.data.filter(i=>(i.value=i.id,i.name=i.department_full_name,i)),this.optionSelect.department_id=e.data.data)})}},mounted(){this.api_master()}},L={class:"master-submin-detail"},C={class:"group-overflow"},N={class:"detail"},M={class:"group-head"},U={class:"group-first"},D={class:"name"},E={class:"group-end"},P={class:"group-detail"},B={class:"group-between"},I={class:"group-input left"},F={class:"group-input"},K={class:"group-between"},O={class:"group-input"},T={class:"group-input"},j={class:"group-between"},G={class:"group-input"},H={class:"group-input"},J={class:"group-between"},Q={class:"group-input"},R={class:"group-footer"},W={class:"footer-left"},X={class:"footer-right"},Y={type:"submit",class:"button-success"};function Z(t,e,i,r,s,o){const m=u("cpn-input"),_=u("cpn-toggleSwitch"),p=u("cpn-autoComplete"),g=u("cpn-textArea"),h=u("Form"),v=u("cpn-modal-alert"),f=u("cpn-loading");return V(),k("div",L,[a("div",C,[a("div",N,[a("div",M,[a("div",U,[e[9]||(e[9]=a("img",{src:b,alt:"",class:"icon-users"},null,-1)),a("div",D,c(s.edit?"แก้ไขกอง":"สร้างกอง"),1)]),a("div",E,[a("button",{type:"button",class:"button-back",onClick:e[0]||(e[0]=d=>o.back())},e[10]||(e[10]=[a("img",{src:w,class:"icon-back"},null,-1),a("img",{src:y,class:"icon-line"},null,-1),l(" ย้อนกลับ ")]))])]),e[21]||(e[21]=a("div",{class:"line"},null,-1)),n(h,{onSubmit:o.onSubmit,onInvalidSubmit:t.onInvalidSubmit},{default:z(()=>[a("div",P,[a("div",B,[a("div",I,[e[11]||(e[11]=a("div",{class:"name"},[l("รหัสกอง"),a("span",{class:"required"},"*")],-1)),n(m,{modelValue:s.data.code,"onUpdate:modelValue":e[1]||(e[1]=d=>s.data.code=d),name:"subminist_id",rules:"required",placeholder:"กรุณาระบุ"},null,8,["modelValue"])]),a("div",F,[e[12]||(e[12]=a("div",{class:"name"},[l("เปิด/ปิดการใช้งาน"),a("span",{class:"required"},"*")],-1)),n(_,{modelValue:s.data.active_flag,"onUpdate:modelValue":e[2]||(e[2]=d=>s.data.active_flag=d),name:"active_flag",class:"",style:{},disabled:!1},null,8,["modelValue"])])]),a("div",K,[a("div",O,[e[13]||(e[13]=a("div",{class:"name"},[l("ชื่อกอง "),a("span",{class:"required"},"*")],-1)),n(m,{modelValue:s.data.Name,"onUpdate:modelValue":e[3]||(e[3]=d=>s.data.Name=d),name:"Name",rules:"required",placeholder:"กรุณาระบุ"},null,8,["modelValue"])]),a("div",T,[e[14]||(e[14]=a("div",{class:"name"},[l("ชื่อย่อกอง "),a("span",{class:"required"},"*")],-1)),n(m,{modelValue:s.data.short_name,"onUpdate:modelValue":e[4]||(e[4]=d=>s.data.short_name=d),name:"short_name",rules:"required",placeholder:"กรุณาระบุ"},null,8,["modelValue"])])]),a("div",j,[a("div",G,[e[15]||(e[15]=a("div",{class:"name"},[l("กระทรวง "),a("span",{class:"required"},"*")],-1)),n(p,{modelValue:s.data.organization_id,"onUpdate:modelValue":e[5]||(e[5]=d=>s.data.organization_id=d),name:"organization_id",rules:"required",placeholder:"กรุณาระบุ",type:"text",disabled:!0,optionSelect:s.optionSelect.organization_id,onChange:o.change},null,8,["modelValue","optionSelect","onChange"])]),a("div",H,[e[16]||(e[16]=a("div",{class:"name"},[l("หน่วยงาน "),a("span",{class:"required"},"*")],-1)),n(p,{modelValue:s.data.department_id,"onUpdate:modelValue":e[6]||(e[6]=d=>s.data.department_id=d),name:"department_id",rules:"required",placeholder:"กรุณาระบุ",type:"text",optionSelect:s.optionSelect.department_id,onChange:o.change,onKeyup:o.keyup_dep},null,8,["modelValue","optionSelect","onChange","onKeyup"])])]),a("div",J,[a("div",Q,[e[17]||(e[17]=a("div",{class:"name"},"รายละเอียด",-1)),n(g,{modelValue:s.data.desc,"onUpdate:modelValue":e[7]||(e[7]=d=>s.data.desc=d),name:"desc",rows:"4",placeholder:"กรุณาระบุ"},null,8,["modelValue"])])])]),e[20]||(e[20]=a("div",{class:"line"},null,-1)),a("div",R,[a("div",W,[a("button",{type:"button",class:"button-danger",onClick:e[8]||(e[8]=d=>o.cancelClick())},e[18]||(e[18]=[a("img",{src:x,alt:"times-circle",class:"icon-times-circle"},null,-1),l(" ยกเลิก ")]))]),a("div",X,[a("button",Y,[e[19]||(e[19]=a("img",{src:A,alt:"times-circle",class:"icon-check-circle"},null,-1)),l(" "+c(s.edit?"ยืนยันแก้ไขกอง":"ยืนยันสร้างกอง"),1)])])])]),_:1},8,["onSubmit","onInvalidSubmit"])])]),n(v,{modalAlert:s.modalAlert},null,8,["modalAlert"]),n(f,{show:s.showLoading},null,8,["show"])])}const ae=S(q,[["render",Z]]);export{ae as default};
