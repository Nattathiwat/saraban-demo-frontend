import{_ as P,r as c,o as n,c as r,a as s,b as d,F as b,h as k,i as y,t as l,n as x,w as _,v as h,j as p}from"./index-c3032b26.js";import{_ as A,a as L}from"./pencil-alt-duotone-a279d8e1.js";import{_ as V}from"./plus-circle-duotone-64bd32fe.js";import{_ as M}from"./user-crown-duotone-30417741.js";import{_ as U}from"./trash-alt-duotone-12d94c28.js";const S="/assets/badge-sheriff-duotone-96ec685f.svg";const D={name:"user-inex",data(){return{modalAlert:{showModal:!1,title:"",message:""},showLoading:!1,data:{search:"",table:[],page:1,total:0,lastPage:0,perPage:50}}},methods:{addClick(){this.$router.push({name:"user-create"}).catch(()=>{})},editClick(a){this.$router.push({name:"user-edit",params:{id:a.id}}).catch(()=>{})},pageChange(a){this.data.perPage=a.perPage,this.data.page=a.page,this.apiUser()},search(){this.data.status=!0,this.data.perPage=50,this.data.page=1,this.apiUser()},apiUser(){this.data.table=[],this.showLoading=!0,this.axios.get("/user",{params:{keyword:this.data.search,page_size:this.data.perPage,page:this.data.page}}).then(a=>{this.showLoading=!1,a.data.data.filter(t=>{t.permission_id=t.role_id,t.permission_name=t.role_name,this.data.total=t.total}),this.data.table=a.data.data,this.data.lastPage=Math.ceil(this.data.total/this.data.perPage)}).catch(a=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:a.response.data.message}})},deleteClick(a){let t=this;this.modalAlert={showModal:!0,type:"confirm",title:"คุณยืนยันการลบผู้ใช้งาน",message:`“${a.fname}  ${a.lname}”  ใช่หรือไม่`,confirm:!0,msgSuccess:!0,afterPressAgree(){t.showLoading=!0,t.axios.delete(`/user/${a.id}`).then(()=>{t.showLoading=!1,t.modalAlert={showModal:!0,type:"success",title:"ทำการลบผู้ใช้งานสำเร็จแล้ว",msgSuccess:!0,afterPressAgree(){t.apiUser()}}}).catch(g=>{t.showLoading=!1,t.modalAlert={showModal:!0,type:"error",title:"Error",message:g.response.data.message}})}}}},mounted(){this.apiUser()}},E={class:"user-inex"},N={class:"group-overflow"},z={class:"detail"},B={class:"group-head"},F={class:"group-first"},j=s("img",{src:A,alt:"",class:"icon-users-cog"},null,-1),T=s("div",{class:"name"},"ผู้ใช้งาน",-1),q=s("div",{class:"group-image"},[s("img",{src:V,alt:"",class:"icon-plus"}),p(" เพิ่มผู้ใช้งาน ")],-1),G=[q],H={class:"group-end"},I={class:"search"},J=s("div",{class:"line"},null,-1),K={class:"group-body"},O={class:"table-user-inex"},Q=s("thead",{class:"thead"},[s("tr",{class:"thead-row"},[s("th",{class:"col1"},"ไอดี"),s("th",{class:"col2"},"ชื่อ-นามสกุล"),s("th",{class:"col3"},"หน่วยงาน"),s("th",{class:"col4"},"ชื่อผู้ใช้งาน"),s("th",{class:"col5"},"Email"),s("th",{class:"col6"},"สิทธิ์"),s("th",{class:"col7"},"เครื่องมือ")])],-1),R={class:"tbody"},W={class:"col1"},X={class:"col2"},Y={class:"col3"},Z={class:"col4"},$={class:"col5"},ss={class:"col6"},es={class:"group-col6"},ts={src:M,alt:"",class:"icon-user-crown"},as={src:S,alt:"",class:"icon-badge-sheriff"},os={class:"col6-detail"},ls=s("div",{class:"image-size"},null,-1),is={class:"col7"},cs={class:"group-icon"},ns=["onClick"],rs=["onClick"],ds={key:0,class:"tbody-row"},_s=s("td",{colspan:"7"},"ไม่มีข้อมูล",-1),hs=[_s],ps={class:"group-footer"};function gs(a,t,g,ms,o,i){const m=c("cpn-input"),u=c("cpn-pagination"),f=c("cpn-modal-alert"),v=c("cpn-loading");return n(),r("div",E,[s("div",N,[s("div",z,[s("div",B,[s("div",F,[j,T,s("button",{type:"button",class:"add-user",onClick:t[0]||(t[0]=e=>i.addClick())},G)]),s("div",H,[s("div",I,[d(m,{modelValue:o.data.search,"onUpdate:modelValue":t[1]||(t[1]=e=>o.data.search=e),name:"search",type:"text",searchFlag:!0,onSearchClick:t[2]||(t[2]=e=>i.search()),placeholder:"กรุณากรอกข้อมูลที่ต้องการค้นหา"},null,8,["modelValue"])])])]),J,s("div",K,[s("table",O,[Q,s("tbody",R,[(n(!0),r(b,null,k(o.data.table,(e,w)=>(n(),r("tr",{class:"tbody-row",key:w},[s("td",W,l(e.id),1),s("td",X,l(e.fname)+" "+l(e.lname),1),s("td",Y,l(e.department_name),1),s("td",Z,l(e.username),1),s("td",$,l(e.email),1),s("td",ss,[s("div",es,[s("span",{class:x(["span",e.permission_id==1?"admin1":e.permission_id==2?"admin2":""])},[_(s("img",ts,null,512),[[h,e.permission_id==1]]),_(s("img",as,null,512),[[h,e.permission_id==2]]),p(" "+l(e.permission_name),1)],2),_(s("div",os,[p(l(e.levelDesc)+" ",1),ls],512),[[h,e.permission_id!=1&&e.permission_id!=2&&e.levelDesc!=""]])])]),s("td",is,[s("div",cs,[s("img",{onClick:C=>i.editClick(e),src:L,alt:"",class:"image-pencil pointer"},null,8,ns),s("img",{onClick:C=>i.deleteClick(e),src:U,alt:"",class:"image-trash pointer"},null,8,rs)])])]))),128)),o.data.table.length==0?(n(),r("tr",ds,hs)):y("",!0)])])]),s("div",ps,[d(u,{page:o.data.page,total:o.data.total,lastPage:o.data.lastPage,perPage:o.data.perPage,onPageChange:i.pageChange},null,8,["page","total","lastPage","perPage","onPageChange"])])])]),d(f,{modalAlert:o.modalAlert},null,8,["modalAlert"]),d(v,{show:o.showLoading},null,8,["show"])])}const Ps=P(D,[["render",gs]]);export{Ps as default};
