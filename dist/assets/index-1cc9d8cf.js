import{_ as y,r,o as c,c as n,a as s,b as d,F as C,h as b,i as k,t as l,n as x,w as _,v as h,j as p}from"./index-426ec220.js";import{_ as A}from"./users-cog-duotone-50670cb2.js";import{_ as L}from"./plus-circle-duotone-64bd32fe.js";import{_ as V}from"./user-crown-duotone-30417741.js";import{_ as M}from"./pencil-alt-duotone-d85ba34f.js";import{_ as U}from"./trash-alt-duotone-12d94c28.js";const S="/assets/badge-sheriff-duotone-96ec685f.svg";const D={name:"user-manage-inex",data(){return{modalAlert:{showModal:!1,title:"",message:""},showLoading:!1,data:{search:"",table:[],page:1,total:0,lastPage:0,perPage:10}}},methods:{addClick(){this.$router.push({name:"user-manage-create"}).catch(()=>{})},editClick(t){this.$router.push({name:"user-manage-edit",params:{id:t.id},query:{page:this.data.page,perPage:this.data.perPage}}).catch(()=>{})},pageChange(t){this.data.perPage=t.perPage,this.data.page=t.page,this.apiUser()},search(){this.data.status=!0,this.data.perPage=50,this.data.page=1,this.apiUser()},apiUser(){this.data.table=[],this.showLoading=!0,this.axios.get("/user",{params:{keyword:this.data.search,page_size:this.data.perPage,page:this.data.page}}).then(t=>{this.showLoading=!1,t.data.data.filter(e=>{e.permission_id=e.role_id,e.permission_name=e.role_name,this.data.total=e.total}),this.data.table=t.data.data,this.data.lastPage=Math.ceil(this.data.total/this.data.perPage)}).catch(t=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:t.response.data.message}})},deleteClick(t){let e=this;this.modalAlert={showModal:!0,type:"confirm",title:"คุณยืนยันการลบผู้ใช้งาน",message:`“${t.fname}  ${t.lname}”  ใช่หรือไม่`,confirm:!0,msgSuccess:!0,afterPressAgree(){e.showLoading=!0,e.axios.delete(`/user/${t.id}`).then(()=>{e.showLoading=!1,e.modalAlert={showModal:!0,type:"success",title:"ทำการลบผู้ใช้งานสำเร็จแล้ว",msgSuccess:!0,afterPressAgree(){e.apiUser()}}}).catch(g=>{e.showLoading=!1,e.modalAlert={showModal:!0,type:"error",title:"Error",message:g.response.data.message}})}}}},mounted(){var t,e;this.data.page=((t=this.$route.query)==null?void 0:t.page)||this.data.page,this.data.perPage=((e=this.$route.query)==null?void 0:e.perPage)||this.data.perPage,this.apiUser()}},E={class:"user-inex"},N={class:"group-overflow"},q={class:"detail"},z={class:"group-head"},B={class:"group-first"},F=s("img",{src:A,alt:"",class:"icon-users-cog"},null,-1),j=s("div",{class:"name"},"ผู้ใช้งาน",-1),T=s("div",{class:"group-image"},[s("img",{src:L,alt:"",class:"icon-plus"}),p(" เพิ่มผู้ใช้งาน ")],-1),$=[T],G={class:"group-end"},H={class:"search"},I=s("div",{class:"line"},null,-1),J={class:"group-body"},K={class:"table-user-inex"},O=s("thead",{class:"thead"},[s("tr",{class:"thead-row"},[s("th",{class:"col1"},"ไอดี"),s("th",{class:"col2"},"ชื่อ-นามสกุล"),s("th",{class:"col3"},"หน่วยงาน"),s("th",{class:"col4"},"ชื่อผู้ใช้งาน"),s("th",{class:"col5"},"Email"),s("th",{class:"col6"},"สิทธิ์"),s("th",{class:"col7"},"เครื่องมือ")])],-1),Q={class:"tbody"},R={class:"col1"},W={class:"col2"},X={class:"col3"},Y={class:"col4"},Z={class:"col5"},ss={class:"col6"},es={class:"group-col6"},as={src:V,alt:"",class:"icon-user-crown"},ts={src:S,alt:"",class:"icon-badge-sheriff"},os={class:"col6-detail"},ls=s("div",{class:"image-size"},null,-1),is={class:"col7"},rs={class:"group-icon"},cs=["onClick"],ns=["onClick"],ds={key:0,class:"tbody-row"},_s=s("td",{colspan:"7"},"ไม่มีข้อมูล",-1),hs=[_s],ps={class:"group-footer"};function gs(t,e,g,ms,o,i){const m=r("cpn-input"),u=r("cpn-pagination"),f=r("cpn-modal-alert"),v=r("cpn-loading");return c(),n("div",E,[s("div",N,[s("div",q,[s("div",z,[s("div",B,[F,j,s("button",{type:"button",class:"add-user",onClick:e[0]||(e[0]=a=>i.addClick())},$)]),s("div",G,[s("div",H,[d(m,{modelValue:o.data.search,"onUpdate:modelValue":e[1]||(e[1]=a=>o.data.search=a),name:"search",type:"text",searchFlag:!0,onSearchClick:e[2]||(e[2]=a=>i.search()),placeholder:"กรุณากรอกข้อมูลที่ต้องการค้นหา"},null,8,["modelValue"])])])]),I,s("div",J,[s("table",K,[O,s("tbody",Q,[(c(!0),n(C,null,b(o.data.table,(a,P)=>(c(),n("tr",{class:"tbody-row",key:P},[s("td",R,l(a.id),1),s("td",W,l(a.fname)+" "+l(a.lname),1),s("td",X,l(a.department_name),1),s("td",Y,l(a.username),1),s("td",Z,l(a.email),1),s("td",ss,[s("div",es,[s("span",{class:x(["span",a.permission_id==1?"admin1":a.permission_id==2?"admin2":""])},[_(s("img",as,null,512),[[h,a.permission_id==1]]),_(s("img",ts,null,512),[[h,a.permission_id==2]]),p(" "+l(a.permission_name),1)],2),_(s("div",os,[p(l(a.levelDesc)+" ",1),ls],512),[[h,a.permission_id!=1&&a.permission_id!=2&&a.levelDesc!=""]])])]),s("td",is,[s("div",rs,[s("img",{onClick:w=>i.editClick(a),src:M,alt:"",class:"image-pencil pointer"},null,8,cs),s("img",{onClick:w=>i.deleteClick(a),src:U,alt:"",class:"image-trash pointer"},null,8,ns)])])]))),128)),o.data.table.length==0?(c(),n("tr",ds,hs)):k("",!0)])])]),s("div",ps,[d(u,{page:o.data.page,total:o.data.total,lastPage:o.data.lastPage,perPage:o.data.perPage,onPageChange:i.pageChange},null,8,["page","total","lastPage","perPage","onPageChange"])])])]),d(f,{modalAlert:o.modalAlert},null,8,["modalAlert"]),d(v,{show:o.showLoading},null,8,["show"])])}const Cs=y(D,[["render",gs]]);export{Cs as default};
