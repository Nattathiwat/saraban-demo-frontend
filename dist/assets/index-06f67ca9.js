import{_ as y,r as p,o as g,c as h,a as e,e as w,b as i,d as P,F as x,i as C,j as L,h as v,t as n}from"./index-6f9b4dc9.js";const U={name:"automail-sendmail-logs",data(){return{modalAlert:{showModal:!1,title:"",message:""},showLoading:!1,data:{regis_id:"",book_out_document_number:"",speed_id:"",subject:"",mnst_id:"",department_dest_id:"",as_of_date:"",to:"",cc:"",bcc:"",send_date:"",table:[],page:1,total:0,lastPage:0,perPage:10},optionSelect:{regis_id:[],speed_id:[],mnst_id:[],department_dest_id:[]}}},methods:{detail_click(d){this.$router.push({name:"subministry-work.booking-out-edit",params:{id:d.book_id}}).catch(()=>{})},cancelClick(){this.data.regis_id="",this.data.book_out_document_number="",this.data.speed_id="",this.data.subject="",this.data.mnst_id="",this.data.department_dest_id="",this.data.as_of_date="",this.data.to="",this.data.cc="",this.data.bcc="",this.data.send_date="",this.data.perPage=10,this.data.page=1,this.apiSendmailLogs()},pageChange(d){this.data.perPage=d.perPage,this.data.page=d.page,this.apiSendmailLogs()},apiSendmailLogs(){var d,t,l,u;this.data.table=[],this.showLoading=!0,this.axios.get("/book-out-external/email-history",{params:{regis_id:this.data.regis_id,book_out_document_number:this.data.book_out_document_number,speed_id:this.data.speed_id,subject:this.data.subject,mnst_id:this.data.mnst_id,department_dest_id:this.data.department_dest_id,as_of_date_from:(d=this.data)==null?void 0:d.as_of_date[0],as_of_date_to:(t=this.data)==null?void 0:t.as_of_date[1],to:this.data.to,cc:this.data.cc,bcc:this.data.bcc,send_date_from:(l=this.data)==null?void 0:l.send_date[0],send_date_to:(u=this.data)==null?void 0:u.send_date[1],page_size:this.data.perPage,page:this.data.page}}).then(a=>{this.showLoading=!1,a.data.data.meta.filter(r=>r.disabled=!0),this.data.table=a.data.data.meta,this.data.total=a.data.data.total,this.data.lastPage=Math.ceil(this.data.total/this.data.perPage)}).catch(a=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:a.response.data.message}})},keyupDepartment(d){this.optionSelect.department_dest_id=[],this.axios.get("/master-data/department",{params:{keyword:d.target.value}}).then(t=>{t.data.data&&(t.data.data.filter(l=>(l.value=l.id,l.name=l.department_full_name,l)),this.optionSelect.department_dest_id=t.data.data)})},keyupSubministry(d){this.optionSelect.mnst_id=[],this.axios.get("/master-data/subministry",{params:{keyword:d.target.value}}).then(t=>{t.data.data&&(t.data.data.filter(l=>(l.value=l.id,l)),this.optionSelect.mnst_id=t.data.data)})},api_master(){this.showLoading=!0;const d=this.axios.get("/master-data/book-type"),t=this.axios.get("/master-data/speed"),l=this.axios.get("/master-data/subministry"),u=this.axios.get("/master-data/department");this.axios.all([d,t,l,u]).then(this.axios.spread((...a)=>{this.showLoading=!1;const r=a[0],_=a[1],c=a[2],m=a[3];r.data.data.filter(o=>(o.value=o.id,o.name=o.desc,o)),_.data.data.filter(o=>(o.value=o.id,o.name=o.desc,o)),c.data.data.filter(o=>(o.value=o.id,o)),m.data.data.filter(o=>(o.value=o.id,o.name=o.department_full_name,o)),this.optionSelect.regis_id=r.data.data,this.optionSelect.speed_id=_.data.data,this.optionSelect.mnst_id=c.data.data,this.optionSelect.department_dest_id=m.data.data,this.apiSendmailLogs()})).catch(a=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:a.response.data.message}})}},mounted(){var d,t;this.data.page=((d=this.$route.query)==null?void 0:d.page)||this.data.page,this.data.perPage=((t=this.$route.query)==null?void 0:t.perPage)||this.data.perPage,this.api_master()}},j={class:"automail-sendmail-logs"},q={class:"group-overflow"},A={class:"detail"},B={class:"group-detail"},N={class:"group-between"},F={class:"group-input"},M={class:"group-input"},D={class:"group-input"},E={class:"group-input"},I={class:"group-between"},T={class:"group-input"},K={class:"group-input"},R={class:"group-input"},z={class:"group-between"},O={class:"group-input"},G={class:"group-input"},H={class:"group-input"},J={class:"group-input"},Q={class:"group-button"},W={class:"button-left"},X={class:"group-body"},Y={class:"table-automail-sendmail-logs"},Z={class:"tbody"},$={class:"col1"},tt={class:"col2"},et={class:"col3"},at=["onClick"],st={class:"col5"},ot={class:"col6"},dt={class:"col7"},lt={class:"col8"},it={class:"col9"},nt={class:"col10"},rt={class:"col11"},ct={class:"col12"},pt={class:"col13"},ut={key:0,class:"tbody-row"},_t={class:"group-footer"};function mt(d,t,l,u,a,r){const _=p("cpn-select"),c=p("cpn-input"),m=p("cpn-autoComplete"),o=p("cpn-datepickerRange"),f=p("Form"),V=p("cpn-pagination"),k=p("cpn-modal-alert"),S=p("cpn-loading");return g(),h("div",j,[e("div",q,[e("div",A,[t[29]||(t[29]=w('<div class="group-head"><div class="group-first"><i class="bi bi-envelope icon-envelope"></i><div class="name">บันทึกการส่งอีเมลอัตโนมัติ</div></div></div><div class="line"></div>',2)),i(f,{onSubmit:r.apiSendmailLogs,onInvalidSubmit:d.onInvalidSubmit},{default:P(()=>[e("div",B,[e("div",N,[e("div",F,[t[14]||(t[14]=e("div",{class:"name"},"ทะเบียน ",-1)),i(_,{modelValue:a.data.regis_id,"onUpdate:modelValue":t[0]||(t[0]=s=>a.data.regis_id=s),name:"regis_id",optionSelect:a.optionSelect.regis_id,placeholder:"กรุณาระบุ"},null,8,["modelValue","optionSelect"])]),e("div",M,[t[15]||(t[15]=e("div",{class:"name"},"เลขออก สลค. ",-1)),i(c,{modelValue:a.data.book_out_document_number,"onUpdate:modelValue":t[1]||(t[1]=s=>a.data.book_out_document_number=s),name:"book_out_document_number",placeholder:"กรุณาระบุ"},null,8,["modelValue"])]),e("div",D,[t[16]||(t[16]=e("div",{class:"name"},"ความเร่งด่วน",-1)),i(_,{modelValue:a.data.speed_id,"onUpdate:modelValue":t[2]||(t[2]=s=>a.data.speed_id=s),name:"speed_id",optionSelect:a.optionSelect.speed_id,placeholder:"กรุณาระบุ"},null,8,["modelValue","optionSelect"])])]),e("div",E,[t[17]||(t[17]=e("div",{class:"name"},"ชื่อเรื่อง ",-1)),i(c,{modelValue:a.data.subject,"onUpdate:modelValue":t[3]||(t[3]=s=>a.data.subject=s),name:"subject",placeholder:"กรุณาระบุ"},null,8,["modelValue"])]),e("div",I,[e("div",T,[t[18]||(t[18]=e("div",{class:"name"},"กอง/สำนัก ",-1)),i(m,{modelValue:a.data.mnst_id,"onUpdate:modelValue":t[4]||(t[4]=s=>a.data.mnst_id=s),name:"mnst_id",optionSelect:a.optionSelect.mnst_id,onKeyup:t[5]||(t[5]=s=>r.keyupSubministry(s)),placeholder:"เลือกกอง/สำนัก"},null,8,["modelValue","optionSelect"])]),e("div",K,[t[19]||(t[19]=e("div",{class:"name"},"ถึง ",-1)),i(m,{modelValue:a.data.department_dest_id,"onUpdate:modelValue":t[6]||(t[6]=s=>a.data.department_dest_id=s),name:"department_dest_id",optionSelect:a.optionSelect.department_dest_id,onKeyup:t[7]||(t[7]=s=>r.keyupDepartment(s)),placeholder:"เลือกหน่วยงานปลายทาง"},null,8,["modelValue","optionSelect"])])]),e("div",R,[t[20]||(t[20]=e("div",{class:"name"},"ลงวันที่ตั้งแต่ - ถึง ",-1)),i(o,{modelValue:a.data.as_of_date,"onUpdate:modelValue":t[8]||(t[8]=s=>a.data.as_of_date=s),name:"as_of_date",placeholder:"เลือกวันที่ - ถึงวันที่"},null,8,["modelValue"])]),e("div",z,[e("div",O,[t[21]||(t[21]=e("div",{class:"name"},"ส่งถึง (TO) ",-1)),i(c,{modelValue:a.data.to,"onUpdate:modelValue":t[9]||(t[9]=s=>a.data.to=s),name:"to",placeholder:"กรุณาระบุ"},null,8,["modelValue"])]),e("div",G,[t[22]||(t[22]=e("div",{class:"name"},"สำเนาถึง (Cc) ",-1)),i(c,{modelValue:a.data.cc,"onUpdate:modelValue":t[10]||(t[10]=s=>a.data.cc=s),name:"cc",placeholder:"กรุณาระบุ"},null,8,["modelValue"])]),e("div",H,[t[23]||(t[23]=e("div",{class:"name"},"สำเนาลับถึง (Bcc)",-1)),i(c,{modelValue:a.data.bcc,"onUpdate:modelValue":t[11]||(t[11]=s=>a.data.bcc=s),name:"bcc",placeholder:"กรุณาระบุ"},null,8,["modelValue"])])]),e("div",J,[t[24]||(t[24]=e("div",{class:"name"},"วันที่ส่งตั้งแต่ - ถึง ",-1)),i(o,{modelValue:a.data.send_date,"onUpdate:modelValue":t[12]||(t[12]=s=>a.data.send_date=s),name:"send_date",placeholder:"เลือกวันที่ - ถึงวันที่"},null,8,["modelValue"])]),e("div",Q,[e("div",W,[e("button",{type:"button",class:"button-warning",onClick:t[13]||(t[13]=s=>r.cancelClick())},t[25]||(t[25]=[e("i",{class:"bi bi-arrow-clockwise icon-clockwise"},null,-1),v(" ล้างการค้นหา ")]))]),t[26]||(t[26]=e("div",{class:"button-right"},[e("button",{type:"submit",class:"button-search"},[e("i",{class:"bi bi-search icon-search"}),v(" ค้นหา ")])],-1))])])]),_:1},8,["onSubmit","onInvalidSubmit"]),t[30]||(t[30]=e("div",{class:"line"},null,-1)),e("div",X,[e("table",Y,[t[28]||(t[28]=e("thead",{class:"thead"},[e("tr",{class:"thead-row"},[e("th",{class:"col1"},"ลำดับ"),e("th",{class:"col2"},"สถานะ"),e("th",{class:"col3"},"วันและเวลาที่ส่ง"),e("th",{class:"col4"},"เลขที่หนังสือส่งออก"),e("th",{class:"col5"},"ทะเบียนหนังสือ"),e("th",{class:"col6"},"ความเร่งด่วน"),e("th",{class:"col7"},"ชื่อเรื่อง"),e("th",{class:"col8"},"ลงวันที่"),e("th",{class:"col9"},"จาก"),e("th",{class:"col10"},"ถึง"),e("th",{class:"col11"},"To"),e("th",{class:"col12"},"Cc"),e("th",{class:"col13"},"Bcc")])],-1)),e("tbody",Z,[(g(!0),h(x,null,C(a.data.table,(s,b)=>(g(),h("tr",{class:"tbody-row",key:b},[e("td",$,n(b+1+a.data.perPage*(a.data.page-1)),1),e("td",tt,n(s.status_name),1),e("td",et,n(s.send_date),1),e("td",{class:"col4",onClick:gt=>r.detail_click(s)},n(s.book_out_document_number),9,at),e("td",st,n(s.book_regis_name),1),e("td",ot,n(s.speed_name),1),e("td",dt,n(s.subject),1),e("td",lt,n(s.as_of_date),1),e("td",it,n(s.from),1),e("td",nt,n(s.department_dest_name),1),e("td",rt,n(s.to),1),e("td",ct,n(s.cc),1),e("td",pt,n(s.bcc),1)]))),128)),a.data.table.length==0?(g(),h("tr",ut,t[27]||(t[27]=[e("td",{colspan:"13"},"ไม่มีข้อมูล",-1)]))):L("",!0)])])]),e("div",_t,[i(V,{page:a.data.page,total:a.data.total,lastPage:a.data.lastPage,perPage:a.data.perPage,onPageChange:r.pageChange},null,8,["page","total","lastPage","perPage","onPageChange"])])])]),i(k,{modalAlert:a.modalAlert},null,8,["modalAlert"]),i(S,{show:a.showLoading},null,8,["show"])])}const bt=y(U,[["render",mt]]);export{bt as default};
