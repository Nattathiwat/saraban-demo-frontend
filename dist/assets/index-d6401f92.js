import{_ as A}from"./users-cog-duotone-50670cb2.js";import{_ as K,r as _,o as c,c as r,a as t,b as i,d as N,F as m,h as y,i as F,e as M,j as S,n as g,t as n}from"./index-adb267a0.js";const V="/assets/envelope-solid-83ddb2ac.svg",B="/assets/share-from-square-solid-59b40d2c.svg";const E={name:"mail-manage-inex",data(){return{modalAlert:{showModal:!1,title:"",message:""},showLoading:!1,data:{search:"",table:[],page:1,total:0,lastPage:0,perPage:10,regis_id:"",department_id:"",department_dest_id:""},optionSelect:{regis_id:[],department_id:[],department_dest_id:[]}}},methods:{sendmailClick(l){this.$router.push({name:"automail-sendmail-edit",params:{id:l.id},query:{page:this.data.page,perPage:this.data.perPage}}).catch(()=>{})},listClick(l){this.$router.push({name:"automail-sendmail-list",params:{id:l.id},query:{page:this.data.page,perPage:this.data.perPage}}).catch(()=>{})},pageChange(l){this.data.perPage=l.perPage,this.data.page=l.page,this.apiSendmailLists()},search(){this.data.status=!0,this.data.perPage=10,this.data.page=1,this.apiSendmailLists()},apiSendmailLists(){this.data.table=[],this.showLoading=!0,this.axios.get("/book-out-external/book-out-automail",{params:{regis_id:this.data.regis_id,department_id:this.data.department_id,department_dest_id:this.data.department_dest_id,page_size:this.data.perPage,page:this.data.page}}).then(l=>{this.showLoading=!1,l.data.data.meta.filter(e=>{let o=0;e.book_series.filter(u=>{o+=u.subs.length}),o+=e.book_series.length,o+=2,e.rowspan=o}),this.data.table=l.data.data.meta,this.data.total=l.data.data.total,this.data.lastPage=Math.ceil(this.data.total/this.data.perPage)}).catch(l=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:l.response.data.message}})},api_master(){this.showLoading=!0;const l=this.axios.get("/master-data/book-category",{params:{book_type:1}}),e=this.axios.get("/master-data/department-user");this.axios.all([l,e]).then(this.axios.spread((...o)=>{this.showLoading=!1;const u=o[0],s=o[1];u.data.data.filter(d=>(d.value=d.id,d.name=d.name,d)),s.data.data.filter(d=>(d.value=d.id,d.name=d.desc,d.human_flag=d.human_flag,d.response_type=d.type,d)),this.optionSelect.regis_id=u.data.data,this.optionSelect.department_dest_id=s.data.data,this.apiSendmailLists()})).catch(o=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:o.response.data.message}})},keyup_regis_type(l){this.optionSelect.sendTo=[],this.axios.get("/master-data/book-category",{params:{keyword:l.target.value}}).then(e=>{e.data.data&&(e.data.data.filter(o=>(o.value=o.id,o.name=o.name,o)),this.optionSelect.regis_id=e.data.data)})},keyup_department(l){this.optionSelect.sendTo=[],this.axios.get("/master-data/department-user",{params:{keyword:l.target.value}}).then(e=>{e.data.data&&(e.data.data.filter(o=>(o.value=o.id,o.name=o.desc,o.human_flag=o.human_flag,o.response_type=o.type,o)),this.optionSelect.regis_id=e.data.data)})}},mounted(){var l,e;this.data.page=((l=this.$route.query)==null?void 0:l.page)||this.data.page,this.data.perPage=((e=this.$route.query)==null?void 0:e.perPage)||this.data.perPage,this.api_master()}},I={class:"mail-inex"},T={class:"group-overflow"},j={class:"detail"},z=M('<div class="group-head"><div class="group-first"><img src="'+A+'" alt="" class="icon-users-cog"><div class="name">รายการหนังสือส่งออก ที่ส่งผ่านอีเมลอัตโนมัติ</div></div></div><div class="line"></div>',2),D={class:"group-detail"},G={class:"group-between"},H={class:"group-input left"},J=t("div",{class:"name"},"ทะเบียน ",-1),O={class:"group-input"},Q=t("div",{class:"name"},"เลขออก สลค.",-1),R={class:"group-between"},W={class:"group-input"},X=t("div",{class:"name"},"เรื่อง",-1),Y={class:"group-between"},Z={class:"group-input left"},$=t("div",{class:"name"},"จาก",-1),tt={class:"group-input"},et=t("div",{class:"name"},"ถึง",-1),st={class:"group-between"},at={class:"group-input left"},ot=t("div",{class:"name"},"จากวันที่",-1),lt={class:"group-input"},dt=t("div",{class:"name"},"ถึงวันที่",-1),nt={class:"group-button"},it={class:"button-left"},ct=t("i",{class:"bi bi-arrow-clockwise icon-clockwise"},null,-1),rt=t("div",{class:"button-right"},[t("button",{type:"submit",class:"button-search"},[t("i",{class:"bi bi-search icon-search"}),S(" ค้นหา ")])],-1),_t={class:"group-body"},pt={class:"table-department-inex"},ut=t("thead",{class:"thead"},[t("tr",{class:"thead-row"},[t("th",{class:"col1"},"ลำดับ"),t("th",{class:"col2"},"ความเร่งด่วน"),t("th",{class:"col3"},"ชั้นความลับ"),t("th",{class:"col4"},"เลขออก สลค."),t("th",{class:"col5"},"ทะเบียนหนังสือ"),t("th",{class:"col6"},"ชื่อเรื่อง"),t("th",{class:"col7"},"ชนิดหนังสือ"),t("th",{class:"col8"},"ลงวันที่"),t("th",{class:"col9"},"จาก"),t("th",{class:"col10"},"ถึง"),t("th",{class:"col11"},[t("img",{src:V,alt:"",class:"icon-send"})])])],-1),ht={class:"tbody"},mt=["rowspan"],gt={class:"col2"},bt={class:"col3"},vt={class:"col4"},yt={class:"col5"},kt={class:"col6"},ft={class:"col7"},wt={class:"col8"},St={class:"col9"},Vt={class:"col10"},Pt=t("td",{class:"col11"},null,-1),Ct={colspan:"10",class:"col2",style:{"text-align":"left"}},Lt={class:"col1"},xt={class:"col2"},qt=t("td",{class:"col3"},null,-1),Ut=t("td",{class:"col4"},null,-1),At=t("td",{class:"col5"},null,-1),Kt=t("td",{class:"col6"},null,-1),Nt=t("td",{class:"col7"},null,-1),Ft=t("td",{class:"col8"},null,-1),Mt=t("td",{class:"col9"},null,-1),Bt={class:"col11"},Et={class:"group-icon"},It=["onClick"],Tt=["onClick"],jt=t("tr",{class:"tbody-row-end2"},[t("td",{colspan:"11"})],-1),zt=t("td",{colspan:"11"},null,-1),Dt=[zt],Gt={key:0,class:"tbody-row"},Ht=t("td",{colspan:"11"},"ไม่มีข้อมูล",-1),Jt=[Ht],Ot={class:"group-footer"};function Qt(l,e,o,u,s,d){const b=_("cpn-autoComplete"),k=_("cpn-input"),f=_("cpn-datepicker"),P=_("Form"),C=_("cpn-pagination"),L=_("cpn-modal-alert"),x=_("cpn-loading");return c(),r("div",I,[t("div",T,[t("div",j,[z,i(P,{onSubmit:d.apiSendmailLists,onInvalidSubmit:l.onInvalidSubmit},{default:N(()=>[t("div",D,[t("div",G,[t("div",H,[J,i(b,{modelValue:s.data.regis_id,"onUpdate:modelValue":e[0]||(e[0]=a=>s.data.regis_id=a),name:"regis_id",onKeyup:d.keyup_regis_type,optionSelect:s.optionSelect.regis_id,placeholder:"กรุณาระบุ"},null,8,["modelValue","onKeyup","optionSelect"])]),t("div",O,[Q,i(k,{modelValue:s.data.document_number,"onUpdate:modelValue":e[1]||(e[1]=a=>s.data.document_number=a),name:"document_number",placeholder:"กรุณาระบุ"},null,8,["modelValue"])])]),t("div",R,[t("div",W,[X,i(k,{modelValue:s.data.name,"onUpdate:modelValue":e[2]||(e[2]=a=>s.data.name=a),name:"name",placeholder:"กรุณาระบุ"},null,8,["modelValue"])])]),t("div",Y,[t("div",Z,[$,i(b,{modelValue:s.data.department_id,"onUpdate:modelValue":e[3]||(e[3]=a=>s.data.department_id=a),name:"department_id",onKeyup:d.keyup_department,optionSelect:s.optionSelect.department_id,placeholder:"กรุณาระบุ"},null,8,["modelValue","onKeyup","optionSelect"])]),t("div",tt,[et,i(b,{modelValue:s.data.department_dest_id,"onUpdate:modelValue":e[4]||(e[4]=a=>s.data.department_dest_id=a),name:"department_dest_id",onKeyup:d.keyup_department,optionSelect:s.optionSelect.department_dest_id,placeholder:"เลือกหน่วยงานปลายทาง"},null,8,["modelValue","onKeyup","optionSelect"])])]),t("div",st,[t("div",at,[ot,i(f,{modelValue:s.data.start_date,"onUpdate:modelValue":e[5]||(e[5]=a=>s.data.start_date=a),name:"start_date",placeholder:"กรุณาระบุ"},null,8,["modelValue"])]),t("div",lt,[dt,i(f,{modelValue:s.data.end_date,"onUpdate:modelValue":e[6]||(e[6]=a=>s.data.end_date=a),name:"end_date",placeholder:"กรุณาระบุ"},null,8,["modelValue"])])]),t("div",nt,[t("div",it,[t("button",{type:"button",class:"button-warning",onClick:e[7]||(e[7]=a=>l.cancelClick())},[ct,S(" ล้างการค้นหา ")])]),rt])])]),_:1},8,["onSubmit","onInvalidSubmit"]),t("div",_t,[t("table",pt,[ut,t("tbody",ht,[(c(!0),r(m,null,y(s.data.table,(a,p)=>(c(),r(m,{key:p},[t("tr",{class:g(["tbody-row tbody-row-index",p%2!=0?"color-tr1":"color-tr2"])},[t("td",{class:g(["col1",p%2!=0?"color-tr1":"color-tr2"]),rowspan:a.rowspan},n(p+1+s.data.perPage*(s.data.page-1)),11,mt),t("td",gt,n(a.speed_name),1),t("td",bt,n(a.secret_name),1),t("td",vt,n(a.book_out_document_number),1),t("td",yt,n(a.book_regis_name),1),t("td",kt,n(a.subject),1),t("td",ft,n(a.book_type_name),1),t("td",wt,n(a.as_of_date),1),t("td",St,n(a.from),1),t("td",Vt,n(a.to),1),Pt],2),(c(!0),r(m,null,y(a.book_series,(w,q)=>(c(),r(m,{key:q},[t("tr",{class:g(["tbody-row",(p%2==0,"color-tr3")])},[t("td",Ct,"ชุดที่"+n(w.no),1)],2),(c(!0),r(m,null,y(w.subs,(h,v)=>(c(),r("tr",{class:g(["tbody-row",v%2!=0?"color-tr1":"color-tr2"]),key:v},[t("td",Lt,[t("div",null,n(v+1)+" "+n(h.book_out_document_number),1),t("div",null,n(h.book_regis_name),1)]),t("td",xt,[t("div",null,n(h.as_of_date),1),t("div",null,n(h.from)+" ถึง "+n(h.to),1)]),qt,Ut,At,Kt,Nt,Ft,Mt,t("td",Bt,[t("div",Et,[t("img",{onClick:U=>d.listClick(a),src:B,alt:"",class:"icon-send pointer"},null,8,It),t("img",{onClick:U=>d.sendmailClick(a),src:V,alt:"",class:"icon-send pointer"},null,8,Tt)])])],2))),128)),jt],64))),128)),t("tr",{class:g(p%2!=0?"tbody-row-end1":"tbody-row-end2")},Dt,2)],64))),128)),s.data.table.length==0?(c(),r("tr",Gt,Jt)):F("",!0)])])]),t("div",Ot,[i(C,{page:s.data.page,total:s.data.total,lastPage:s.data.lastPage,perPage:s.data.perPage,onPageChange:d.pageChange},null,8,["page","total","lastPage","perPage","onPageChange"])])])]),i(L,{modalAlert:s.modalAlert},null,8,["modalAlert"]),i(x,{show:s.showLoading},null,8,["show"])])}const Xt=K(E,[["render",Qt]]);export{Xt as default};
