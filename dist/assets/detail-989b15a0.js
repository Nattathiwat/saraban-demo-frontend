import{_ as D,r as m,o as f,c as v,a as e,t as A,b as d,d as I,F as C,h as q,n as M,j as u,w as R,g as F,k as L,v as j}from"./index-65290fd3.js";import{_ as E}from"./ballot-duotone-f2459825.js";import{_ as T}from"./plus-circle-duotone-64bd32fe.js";import{_ as x}from"./trash-alt-duotone-12d94c28.js";const N={name:"import-book-detail",data(){return{modalAlert:{showModal:!1,title:"",message:""},showLoading:!1,edit:!1,flagSave:1,data:{original_flag:!1,receive_regis_id:"",book_type_id:"",receive_date:this.assetsUtils.currentDate(),receive_time:this.assetsUtils.currentTime(),document_number:"",as_of_date:this.assetsUtils.currentDate(),subject:"",secret_id:"",speed_id:"",send_to:"",book_desc:"",tag:[],contracts:[{department_id:"",receive_type:"",contract_name:"",contract_phone:"",contract_fax:""}],main_docs:[{filename:"",file:[]}],attachments:[{filename:"",file:[]}],booking_refers:[{receive_document_number:"",desc:"",receive_date:"",book_refer_id:"",original_refer_id:"",book_type:""}],sendTo:[],comment:"",process_type_id:"",permission_id:""},optionSelect:{receive_regis_id:[],book_type_id:[],secret_id:[],speed_id:[],department_id:[],receive_type:[],process_type_id:[],permission_id:[],sendTo:[]}}},methods:{keyupSendTo(a){this.optionSelect.sendTo=[],this.axios.get("/department",{params:{keyword:a.target.value}}).then(o=>{o.data.data&&(o.data.data.filter(i=>(i.value=i.id,i.name=i.department_full_name,i)),this.optionSelect.sendTo=o.data.data)})},sendToClick(){this.axios.get("/v1/login")},booking_refersClick(a){this.showLoading=!0,this.axios.get("/master-data/book-refer",{params:{keyword:a.receive_document_number}}).then(o=>{this.showLoading=!1,o.data.data.length>0?(a.book_refer_id=o.data.data[0].id,a.original_refer_id=o.data.data[0].id,a.book_type=o.data.data[0].book_type,a.desc=o.data.data[0].desc,a.receive_date=o.data.data[0].receive_date):(a.receive_document_number="",a.book_refer_id="",a.original_refer_id="",a.book_type="",a.original_refer_id="",a.dreceive_dateate="",this.modalAlert={showModal:!0,type:"error",title:"",message:"ไม่พบหนังสืออ้างอิง"})}).catch(o=>{a.receive_document_number="",a.book_refer_id="",a.original_refer_id="",a.book_type="",a.original_refer_id="",a.dreceive_dateate="",this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"",message:"ไม่พบหนังสืออ้างอิง"}})},downloadFile(a){a.filename&&a.type=="pdf"&&this.axios({method:"get",url:a.link,baseURL:"",responseType:"blob"}).then(o=>{const i=new Blob([o.data],{type:"application/pdf"});window.open(URL.createObjectURL(i))})},uploadFile(a){document.querySelector(`[name="${a}"]`).click()},fileSetChange(a,o,i){for(var _=0;_<document.querySelector(`[name="${a}"]`).files.length;_++){let s=document.querySelector(`[name="${a}"]`).files[_];if(i=="main_docs"){if(s.type=="application/pdf"){let l={filename:s.name,type:s.type=="application/pdf"?"pdf":"",link:URL.createObjectURL(s),size:(s.size/1024/1024).toFixed(2)+" MB",file:s};this.data[i][o]=l,document.querySelector(`[name="${a}"]`).value=null}}else{let l={filename:s.name,type:s.type=="application/pdf"?"pdf":"",link:URL.createObjectURL(s),size:(s.size/1024/1024).toFixed(2)+" MB",file:s};this.data[i][o]=l,document.querySelector(`[name="${a}"]`).value=null}}},back(){this.$router.push({name:"import-book"}).catch(()=>{})},onSubmit(){let a=this;this.modalAlert={showModal:!0,type:"confirm",title:`คุณยืนยันการ${this.flagSave==1?"บันทึกแบบร่าง":"บันทึกและส่งต่อ"}หรือไม่`,confirm:!0,msgSuccess:!0,afterPressAgree(){this.showLoading=!0,a.data.main_docs.length>0||a.data.attachments.length>0?a.uploadFileAll():a.callApiSave([],[])}}},uploadFileAll(){let a=this.assetsUtils.currentDate(),o=[],i=[],_=[],s=[];this.data.main_docs.filter(l=>{if(l.filename){let r=new FormData;r.append("file",l.file),r.append("dst",`${a.split("/")[0]+"-"+a.split("/")[1]+"-"+a.split("/")[2]}`),o.push(this.axios.post("/upload/single",r,{headers:{"Content-Type":"multipart/form-data"}}))}}),o.length>0&&this.axios.all([...o]).then(this.axios.spread((...l)=>{l.filter(r=>{_.push(r.data.data)}),o.length==_.length&&i.length==s.length&&this.callApiSave(_,s)})).catch(l=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:l.response.data.message}}),i.length>0&&(this.data.attachments.filter(l=>{if(l.filename){let r=new FormData;r.append("file",l.file),r.append("dst",`${a.split("/")[0]+"-"+a.split("/")[1]+"-"+a.split("/")[2]}`),i.push(this.axios.post("/upload/single",r,{headers:{"Content-Type":"multipart/form-data"}}))}}),this.axios.all([...i]).then(this.axios.spread((...l)=>{l.filter(r=>{s.push(r.data.data)}),o.length==_.length&&i.length==s.length&&this.callApiSave(_,s)})).catch(l=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:l.response.data.message}})),o.length<1&&i.length<1&&this.callApiSave([],[])},callApiSave(a,o){let i=this,_="";this.data.tag.filter(r=>{_+=r.name+","}),_.slice(0,-1);let s=[];this.data.sendTo.filter(r=>{s.push({department_id:parseInt(r.value),comment:this.data.comment,process_type_id:parseInt(this.data.process_type_id),permission_id:parseInt(this.data.permission_id)})});let l={original_flag:this.data.original_flag,receive_regis_id:parseInt(this.data.receive_regis_id),book_type_id:parseInt(this.data.book_type_id),receive_date:this.assetsUtils.yearDel543(this.data.receive_date),receive_time:this.data.receive_time,as_of_date:this.assetsUtils.yearDel543(this.data.as_of_date),document_number:this.data.document_number,subject:this.data.subject,secret_id:parseInt(this.data.secret_id),speed_id:parseInt(this.data.speed_id),send_to:this.data.send_to,book_desc:this.data.book_desc,tag:_,contracts:this.data.contracts,main_docs:a,attachments:o,booking_refers:this.data.booking_refers[0].book_refer_id?this.data.booking_refers:[],booking_follows:s,user_id:parseInt(localStorage.getItem("user_id")),flag:this.flagSave==1?"draft":""};this.edit?this.flagSave==1?(this.showLoading=!0,this.axios.put(`/booking-receive/${this.$route.params.id}`,l).then(()=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"success",title:"ทำการบันทึกแบบร่างสำเร็จแล้ว",msgSuccess:!0,afterPressAgree(){i.back()}}}).catch(r=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:r.response.data.message}})):(this.showLoading=!0,this.axios.put(`/booking-receive/${this.$route.params.id}`,l).then(()=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"success",title:"ทำการบันทึกและส่งต่อสำเร็จแล้ว",msgSuccess:!0,afterPressAgree(){i.back()}}}).catch(r=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:r.response.data.message}})):this.flagSave==1?(this.showLoading=!0,this.axios.post("/booking-receive",l).then(()=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"success",title:"ทำการบันทึกแบบร่างสำเร็จแล้ว",msgSuccess:!0,afterPressAgree(){i.back()}}}).catch(r=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:r.response.data.message}})):(this.showLoading=!0,this.axios.post("/booking-receive",l).then(()=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"success",title:"ทำการบันทึกและส่งต่อสำเร็จแล้ว",msgSuccess:!0,afterPressAgree(){i.back()}}}).catch(r=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:r.response.data.message}}))},apiDetail(){this.showLoading=!0,this.axios.get(`/booking-receive/${this.$route.params.id}`).then(a=>{var o;this.showLoading=!1,this.data=JSON.parse(JSON.stringify(a.data.data)),this.data.tag=[],(o=a.data.data.tag)==null||o.split(",").filter(i=>{i&&this.data.tag.push({value:"",name:i})}),this.data.sendTo=[],a.data.data.booking_follows.filter(i=>{this.data.sendTo.push({value:i.department_id,name:i.department_name}),this.data.comment=i.comment,this.data.process_type_id=i.process_type_id,this.data.permission_id=i.permission_id}),this.data.booking_refers=[],a.data.data.booking_refers.filter(i=>{this.axios.get(`/master-data/book-refer/${i.book_type}/${i.id}`).then(_=>{this.data.booking_refers.push({...i,..._.data.data})}).catch(_=>{this.modalAlert={showModal:!0,type:"error",title:"Error",message:_.response.data.message}})}),this.data.main_docs.length<1&&(this.data.main_docs=[{filename:"",file:[]}]),this.data.attachments.length<1&&(this.data.attachments=[{filename:"",file:[]}])}).catch(a=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:a.response.data.message}})},apiMaster(){this.showLoading=!0;const a=this.axios.get("/master-data/register-type"),o=this.axios.get("/master-data/book-type"),i=this.axios.get("/master-data/secret"),_=this.axios.get("/master-data/speed"),s=this.axios.get("/master-data/process-type"),l=this.axios.get("/master-data/permission-type"),r=this.axios.get("/department"),h=this.axios.get("/master-data/receive-type");this.axios.all([a,o,i,_,s,l,r,h]).then(this.axios.spread((...p)=>{this.showLoading=!1;const V=p[0],g=p[1],b=p[2],y=p[3],w=p[4],S=p[5],U=p[6],k=p[7];V.data.data.filter(t=>(t.value=t.id,t.name=t.desc,t)),g.data.data.filter(t=>(t.value=t.id,t.name=t.desc,t)),b.data.data.filter(t=>(t.value=t.id,t.name=t.desc,t)),y.data.data.filter(t=>(t.value=t.id,t.name=t.desc,t)),w.data.data.filter(t=>(t.value=t.id,t.name=t.desc,t)),S.data.data.filter(t=>(t.value=t.id,t.name=t.desc,t)),U.data.data.filter(t=>(t.value=t.id,t.name=t.department_full_name,t)),k.data.data.filter(t=>(t.value=t.id,t.name=t.desc,t)),this.optionSelect.receive_regis_id=V.data.data,this.optionSelect.book_type_id=g.data.data,this.optionSelect.secret_id=b.data.data,this.optionSelect.speed_id=y.data.data,this.optionSelect.process_type_id=w.data.data,this.optionSelect.permission_id=S.data.data,this.optionSelect.department_id=U.data.data,this.optionSelect.receive_type=k.data.data,this.$route.params.id?(this.edit=!0,this.apiDetail()):this.edit=!1})).catch(p=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:p.response.data.message}})}},mounted(){this.apiMaster()},watch:{"modalRegiter.showModal"(){document.body.style.overflow=this.modalRegiter.showModal?"hidden":""}}},z={class:"import-book-detail"},B={class:"group-overflow"},O={class:"detail"},P={class:"group-head"},J={class:"group-first"},K=e("img",{src:E,alt:"",class:"icon-size"},null,-1),G={class:"name"},H=e("div",{class:"line"},null,-1),Q={class:"group-detail"},W={class:"group-input"},X={class:"group-between"},Y={class:"group-input left"},Z=e("div",{class:"name"},[u("ทะเบียนรับ "),e("span",{class:"required"},"*")],-1),$={class:"group-between"},ee={class:"group-input left"},te=e("div",{class:"name"},[u("วันที่รับหนังสือ "),e("span",{class:"required"},"*")],-1),se={class:"group-input"},oe=e("div",{class:"name"},[u("เวลาที่รับหนังสือ "),e("span",{class:"required"},"*")],-1),ae={class:"group-between"},ie={class:"group-input left"},le=e("div",{class:"name"},[u("ชนิดของหนังสือ "),e("span",{class:"required"},"*")],-1),ne={class:"group-between"},de={class:"group-input left"},re=e("div",{class:"name"},[u("เลขที่หนังสือ "),e("span",{class:"required"},"*")],-1),ce={class:"group-input"},_e=e("div",{class:"name"},[u("ลงวันที่ "),e("span",{class:"required"},"*")],-1),ue={class:"group-input d-flex align-items-center"},pe=e("div",{class:"name"},"อ้างอิงถึง",-1),he=e("div",{class:"group-image"},[e("img",{src:T,alt:"",class:"icon-plus"}),u(" เพิ่มเอกสารอ้างอิง ")],-1),me=[he],ge={class:"group-input left"},fe={class:"group-input left"},ve={class:"group-input d-flex"},be=["onClick"],ye=e("img",{src:x,alt:"",class:"image-trash pointer"},null,-1),ke=[ye],Ve=e("div",{class:"group-input"},null,-1),we={class:"group-between"},Se={class:"group-input left"},Ue=e("div",{class:"name"},[u("ชื่อเรื่อง "),e("span",{class:"required"},"*")],-1),Ce={class:"group-between"},qe={class:"group-input left"},Ae=e("div",{class:"name"},[u("ชั้นความลับ "),e("span",{class:"required"},"*")],-1),Le={class:"group-input"},xe=e("div",{class:"name"},[u("ความเร่งด่วน "),e("span",{class:"required"},"*")],-1),Me={class:"group-input left"},Fe=e("div",{class:"name"},[u("เรียน "),e("span",{class:"required"},"*")],-1),Te={class:"group-input left"},De=e("div",{class:"name"},"รายละเอียดหนังสือ",-1),Ie={class:"group-input"},Re=e("div",{class:"name"},'Tag สำหรับค้นหา (กรอกข้อมูลจบ 1 ประโยค ให้กด "Enter")',-1),je=e("div",{class:"line"},null,-1),Ee={class:"group-between"},Ne={class:"group-input left"},ze=e("div",{class:"name"},[u("หน่วยงานที่เสนอเรื่อง "),e("span",{class:"required"},"*")],-1),Be={class:"group-input"},Oe=e("div",{class:"name"},[u("ช่องทางการรับเอกสาร "),e("span",{class:"required"},"*")],-1),Pe={class:"group-between"},Je={class:"group-input left"},Ke=e("div",{class:"name"},"ผู้ติดต่อ",-1),Ge={class:"group-between"},He={class:"group-input left"},Qe=e("div",{class:"name"},"โทรศัพท์",-1),We={class:"group-input"},Xe=e("div",{class:"name"},"โทรสาร",-1),Ye=e("div",{class:"line"},null,-1),Ze={class:"group-detail"},$e={class:"group-between"},et={class:"group-input left"},tt=e("div",{class:"name"},"หนังสือต้นเรื่อง",-1),st={class:"group-input-file"},ot=["onClick"],at=["onClick"],it=["onChange","name"],lt=["onClick"],nt=e("i",{class:"bi bi-eye icon-eye"},null,-1),dt=[nt],rt=["onClick"],ct=e("img",{src:x,alt:"",class:"image-trash pointer"},null,-1),_t=[ct],ut={class:"group-input"},pt={class:"group-input d-flex align-items-center"},ht=e("div",{class:"name"},"สิ่งที่ส่งมาด้วย",-1),mt=e("div",{class:"group-image"},[e("img",{src:T,alt:"",class:"icon-plus"}),u(" เพิ่มไฟล์ ")],-1),gt=[mt],ft={class:"group-input-file"},vt=["onClick"],bt=["onClick"],yt=["onChange","name"],kt=["onClick"],Vt=e("i",{class:"bi bi-eye icon-eye"},null,-1),wt=[Vt],St=["onClick"],Ut=e("img",{src:x,alt:"",class:"image-trash pointer"},null,-1),Ct=[Ut],qt=e("div",{class:"line"},null,-1),At={class:"send-to"},Lt={class:"group-input"},xt=e("div",{class:"name"},[u("ส่งต่อ(กรอกข้อมูล และคลิกเลือกรายชื่อ) "),e("span",{class:"required"},"*กรุณาใส่รายชื่อที่ต้องการส่งต่อ")],-1),Mt={class:"group-input"},Ft=e("div",{class:"name"},"ความเห็น / คำสั่ง",-1),Tt={class:"group-between"},Dt={class:"group-input left"},It=e("div",{class:"name"},"รูปแบบการดำเนินการ",-1),Rt={class:"group-input"},jt=e("div",{class:"name"},"การมองเห็น",-1),Et={class:"d-flex align-items-center justify-content-between"},Nt=e("img",{src:F,alt:"times-circle",class:"icon-times-circle"},null,-1),zt=e("img",{src:L,alt:"times-circle",class:"icon-check-circle"},null,-1),Bt=e("div",{class:"line mt-4"},null,-1),Ot={class:"group-footer"},Pt={class:"footer-left"},Jt=e("img",{src:F,alt:"times-circle",class:"icon-times-circle"},null,-1),Kt={class:"footer-right"},Gt=e("img",{src:L,alt:"times-circle",class:"icon-check-circle"},null,-1),Ht=["disabled"],Qt=e("img",{src:L,alt:"times-circle",class:"icon-check-circle"},null,-1);function Wt(a,o,i,_,s,l){const r=m("cpn-checkbox"),h=m("cpn-select"),p=m("cpn-datepicker"),V=m("cpn-time"),g=m("cpn-input"),b=m("cpn-textArea"),y=m("cpn-input-tags"),w=m("Form"),S=m("cpn-modal-alert"),U=m("cpn-loading");return f(),v("div",z,[e("div",B,[e("div",O,[e("div",P,[e("div",J,[K,e("div",G,A(s.edit?"แก้ไขหนังสือรับเข้า":"สร้างหนังสือรับเข้า"),1)])]),H,d(w,{onSubmit:l.onSubmit,onInvalidSubmit:a.onInvalidSubmit},{default:I(()=>{var k;return[e("div",Q,[e("div",W,[d(r,{modelValue:s.data.original_flag,"onUpdate:modelValue":o[0]||(o[0]=t=>s.data.original_flag=t),name:"original_flag",label:"หนังสือต้นเรื่อง"},null,8,["modelValue"])]),e("div",X,[e("div",Y,[Z,d(h,{modelValue:s.data.receive_regis_id,"onUpdate:modelValue":o[1]||(o[1]=t=>s.data.receive_regis_id=t),name:"receive_regis_id",rules:"required",optionSelect:s.optionSelect.receive_regis_id,placeholder:"กรุณาระบุ"},null,8,["modelValue","optionSelect"])]),e("div",$,[e("div",ee,[te,d(p,{modelValue:s.data.receive_date,"onUpdate:modelValue":o[2]||(o[2]=t=>s.data.receive_date=t),name:"receive_date",rules:"required",placeholder:"กรุณาระบุ"},null,8,["modelValue"])]),e("div",se,[oe,d(V,{modelValue:s.data.receive_time,"onUpdate:modelValue":o[3]||(o[3]=t=>s.data.receive_time=t),name:"receive_time",rules:"required",placeholder:"กรุณาระบุ"},null,8,["modelValue"])])])]),e("div",ae,[e("div",ie,[le,d(h,{modelValue:s.data.book_type_id,"onUpdate:modelValue":o[4]||(o[4]=t=>s.data.book_type_id=t),name:"book_type_id",rules:"required",optionSelect:s.optionSelect.book_type_id,placeholder:"กรุณาระบุ"},null,8,["modelValue","optionSelect"])]),e("div",ne,[e("div",de,[re,d(g,{modelValue:s.data.document_number,"onUpdate:modelValue":o[5]||(o[5]=t=>s.data.document_number=t),name:"document_number",rules:"required",placeholder:"กรุณาระบุ"},null,8,["modelValue"])]),e("div",ce,[_e,d(p,{modelValue:s.data.as_of_date,"onUpdate:modelValue":o[6]||(o[6]=t=>s.data.as_of_date=t),name:"as_of_date",rules:"required",placeholder:"กรุณาระบุ"},null,8,["modelValue"])])])]),e("div",ue,[pe,e("button",{type:"button",class:"add-import-book",onClick:o[7]||(o[7]=t=>s.data.booking_refers.push({book_refer_id:"",original_refer_id:"",book_type:"",date:""}))},me)]),(f(!0),v(C,null,q(s.data.booking_refers,(t,n)=>(f(),v("div",{class:"group-between",key:n},[e("div",ge,[d(g,{modelValue:t.receive_document_number,"onUpdate:modelValue":c=>t.receive_document_number=c,name:`codeRefers${n}`,type:"text",searchFlag:!0,onSearchClick:c=>l.booking_refersClick(t),placeholder:"เลขที่หนังสืออ้างอิง"},null,8,["modelValue","onUpdate:modelValue","name","onSearchClick"])]),e("div",fe,[d(g,{modelValue:t.desc,"onUpdate:modelValue":c=>t.desc=c,name:`nameRefers${n}`,disabled:!0,placeholder:"ชื่อเรื่อง"},null,8,["modelValue","onUpdate:modelValue","name"])]),e("div",ve,[d(p,{modelValue:t.receive_date,"onUpdate:modelValue":c=>t.receive_date=c,name:`dateRefers${n}`,disabled:!0,placeholder:"วันที่รับหนังสือ"},null,8,["modelValue","onUpdate:modelValue","name"]),e("button",{type:"button",onClick:c=>(s.data.booking_refers.length>1?s.data.booking_refers.splice(n,1):t.book_refer_id="",t.original_refer_id="",t.date=""),class:"button-delete ms-3"},ke,8,be)])]))),128)),Ve,e("div",we,[e("div",Se,[Ue,d(b,{modelValue:s.data.subject,"onUpdate:modelValue":o[8]||(o[8]=t=>s.data.subject=t),name:"subject",rules:"required",rows:"3"},null,8,["modelValue"])]),e("div",Ce,[e("div",qe,[Ae,d(h,{modelValue:s.data.secret_id,"onUpdate:modelValue":o[9]||(o[9]=t=>s.data.secret_id=t),name:"secret_id",rules:"required",optionSelect:s.optionSelect.secret_id,placeholder:"กรุณาระบุ"},null,8,["modelValue","optionSelect"])]),e("div",Le,[xe,d(h,{modelValue:s.data.speed_id,"onUpdate:modelValue":o[10]||(o[10]=t=>s.data.speed_id=t),name:"speed_id",rules:"required",optionSelect:s.optionSelect.speed_id,placeholder:"กรุณาระบุ"},null,8,["modelValue","optionSelect"])])])]),e("div",Me,[Fe,d(b,{modelValue:s.data.send_to,"onUpdate:modelValue":o[11]||(o[11]=t=>s.data.send_to=t),name:"send_to",rules:"required",rows:"1"},null,8,["modelValue"])]),e("div",Te,[De,d(b,{modelValue:s.data.book_desc,"onUpdate:modelValue":o[12]||(o[12]=t=>s.data.book_desc=t),name:"book_desc",rows:"1"},null,8,["modelValue"])]),e("div",Ie,[Re,d(y,{modelValue:s.data.tag,"onUpdate:modelValue":o[13]||(o[13]=t=>s.data.tag=t),name:"tag"},null,8,["modelValue"])])]),je,(f(!0),v(C,null,q(s.data.contracts,(t,n)=>(f(),v("div",{class:"group-detail",key:n},[e("div",Ee,[e("div",Ne,[ze,d(h,{modelValue:t.department_id,"onUpdate:modelValue":c=>t.department_id=c,name:`${n}department_id`,rules:"required",optionSelect:s.optionSelect.department_id},null,8,["modelValue","onUpdate:modelValue","name","optionSelect"])]),e("div",Be,[Oe,d(h,{modelValue:t.receive_type,"onUpdate:modelValue":c=>t.receive_type=c,name:`${n}receive_type`,rules:"required",optionSelect:s.optionSelect.receive_type},null,8,["modelValue","onUpdate:modelValue","name","optionSelect"])])]),e("div",Pe,[e("div",Je,[Ke,d(g,{modelValue:t.contract_name,"onUpdate:modelValue":c=>t.contract_name=c,name:`${n}contract_name`},null,8,["modelValue","onUpdate:modelValue","name"])]),e("div",Ge,[e("div",He,[Qe,d(g,{modelValue:t.contract_phone,"onUpdate:modelValue":c=>t.contract_phone=c,isNumber:!0,maxlength:"10",name:`${n}contract_phone`},null,8,["modelValue","onUpdate:modelValue","name"])]),e("div",We,[Xe,d(g,{modelValue:t.contract_fax,"onUpdate:modelValue":c=>t.contract_fax=c,isNumber:!0,maxlength:"10",name:`${n}contract_fax`},null,8,["modelValue","onUpdate:modelValue","name"])])])])]))),128)),Ye,e("div",Ze,[e("div",$e,[e("div",et,[tt,(f(!0),v(C,null,q(s.data.main_docs,(t,n)=>(f(),v("div",{class:"d-flex mb-3",key:n},[e("div",st,[e("button",{type:"button",class:"button-file",onClick:c=>l.uploadFile(`main_docs${n}`)},[e("span",{class:M(t.filename?"":"no-data")},A(t.filename?t.filename:"หนังสือต้นเรื่อง"),3)],8,ot),e("div",{class:"text pointer",onClick:c=>l.uploadFile(`main_docs${n}`)},"แนบเอกสาร",8,at),e("input",{type:"file",onChange:c=>l.fileSetChange(`main_docs${n}`,n,"main_docs"),name:`main_docs${n}`,style:{display:"none"},accept:"application/pdf"},null,40,it)]),e("button",{type:"button",onClick:c=>l.downloadFile(t),class:"button-eye"},dt,8,lt),e("button",{type:"button",class:"del-department-3",onClick:c=>s.data.main_docs.length>1?s.data.main_docs.splice(n,1):t.filename=""},_t,8,rt)]))),128))]),e("div",ut,[e("div",pt,[ht,e("button",{type:"button",class:"add-import-book",onClick:o[14]||(o[14]=t=>s.data.attachments.push({filename:"",file:[]}))},gt)]),(f(!0),v(C,null,q(s.data.attachments,(t,n)=>(f(),v("div",{class:"d-flex mb-3",key:n},[e("div",ft,[e("button",{type:"button",class:"button-file",onClick:c=>l.uploadFile(`attachments${n}`)},[e("span",{class:M(t.filename?"":"no-data")},A(t.filename?t.filename:"สิ่งที่ส่งมาด้วย"),3)],8,vt),e("div",{class:"text pointer",onClick:c=>l.uploadFile(`attachments${n}`)},"แนบเอกสาร",8,bt),e("input",{type:"file",onChange:c=>l.fileSetChange(`attachments${n}`,n,"attachments"),name:`attachments${n}`,style:{display:"none"}},null,40,yt)]),e("button",{type:"button",onClick:c=>l.downloadFile(t),class:"button-eye"},wt,8,kt),e("button",{type:"button",class:"del-department-3",onClick:c=>s.data.attachments.length>1?s.data.attachments.splice(n,1):t.filename=""},Ct,8,St)]))),128))])])]),qt,e("div",At,[e("div",Lt,[xt,d(y,{modelValue:s.data.sendTo,"onUpdate:modelValue":o[15]||(o[15]=t=>s.data.sendTo=t),flagSearch:!0,optionSelect:s.optionSelect.sendTo,onKeyup:l.keyupSendTo,name:"sendTo"},null,8,["modelValue","optionSelect","onKeyup"])]),e("div",Mt,[Ft,d(b,{modelValue:s.data.comment,"onUpdate:modelValue":o[16]||(o[16]=t=>s.data.comment=t),name:"comment",rows:"3"},null,8,["modelValue"])]),e("div",Tt,[e("div",Dt,[It,d(h,{modelValue:s.data.process_type_id,"onUpdate:modelValue":o[17]||(o[17]=t=>s.data.process_type_id=t),name:"process_type_id",optionSelect:s.optionSelect.process_type_id},null,8,["modelValue","optionSelect"])]),e("div",Rt,[jt,d(h,{modelValue:s.data.permission_id,"onUpdate:modelValue":o[18]||(o[18]=t=>s.data.permission_id=t),name:"permission_id",optionSelect:s.optionSelect.permission_id},null,8,["modelValue","optionSelect"])])]),e("div",Et,[e("div",null,[e("button",{type:"button",class:"button button-danger",onClick:o[19]||(o[19]=t=>(s.data.sendTo=[],s.data.comment="",s.data.process_type_id="",s.data.permission_id=""))},[Nt,u(" ยกเลิก ")])]),e("div",null,[R(e("button",{type:"button",onClick:o[20]||(o[20]=t=>l.sendToClick()),class:"button button-success"},[zt,u(" เพิ่มการส่งต่อ ")],512),[[j,!1]])])])]),Bt,e("div",Ot,[e("div",Pt,[e("button",{type:"button",class:"button-danger",onClick:o[21]||(o[21]=t=>l.back())},[Jt,u(" ปิด ")])]),e("div",Kt,[e("button",{type:"submit",class:"button-primary",onClick:o[22]||(o[22]=t=>s.flagSave=1)},[Gt,u(" บันทึกแบบร่าง ")]),e("button",{type:"submit",class:"button-success",onClick:o[23]||(o[23]=t=>s.flagSave=2),disabled:((k=s.data.sendTo)==null?void 0:k.length)<1},[Qt,u(" บันทึกและส่งต่อ ")],8,Ht)])])]}),_:1},8,["onSubmit","onInvalidSubmit"])])]),d(S,{modalAlert:s.modalAlert},null,8,["modalAlert"]),d(U,{show:s.showLoading},null,8,["show"])])}const es=D(N,[["render",Wt]]);export{es as default};
