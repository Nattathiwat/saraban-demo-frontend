import{_ as P,r as c,o as _,c as h,a as e,b as l,d as C,n as k,F as A,h as M,i as U,e as L,j as v,t as b,w as p,v as u,k as S,g as x}from"./index-c80e8212.js";import{_ as B}from"./pencil-alt-duotone-d85ba34f.js";const N={name:"agency-inex",data(){return{modalAlert:{showModal:!1,title:"",message:""},showLoading:!1,data:{short_name:"",department_name:"",to:"",cc:"",bcc:"",table:[],page:1,total:0,lastPage:0,perPage:10}}},methods:{cancelClick(){this.data.short_name="",this.data.department_name="",this.data.to="",this.data.cc="",this.data.bcc="",this.data.perPage=10,this.data.page=1,this.apiMailAddress()},pageChange(o){this.data.perPage=o.perPage,this.data.page=o.page,this.apiMailAddress()},save(o){let s=this,m={to:o.to,cc:o.cc,bcc:o.bcc};this.showLoading=!0,this.axios.put(`/master-data/department-contact/${o.id}`,m).then(()=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"success",title:"ทำการแก้ไขอีเมล์ติดต่อหน่วยงานสำเร็จแล้ว",msgSuccess:!0,afterPressAgree(){s.apiMailAddress()}}}).catch(g=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:g.response.data.message}})},apiMailAddress(){this.data.table=[],this.showLoading=!0,this.axios.get("/master-data/department-contact",{params:{short_name:this.data.short_name,department_name:this.data.department_name,to:this.data.to,cc:this.data.cc,bcc:this.data.bcc,page_size:this.data.perPage,page:this.data.page}}).then(o=>{this.showLoading=!1,o.data.data.meta.filter(s=>s.disabled=!0),this.data.table=o.data.data.meta,this.data.total=o.data.data.total,this.data.lastPage=Math.ceil(this.data.total/this.data.perPage)}).catch(o=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:o.response.data.message}})}},mounted(){var o,s;this.data.page=((o=this.$route.query)==null?void 0:o.page)||this.data.page,this.data.perPage=((s=this.$route.query)==null?void 0:s.perPage)||this.data.perPage,this.apiMailAddress()}},F={class:"master-mail-addresses"},E={class:"group-overflow"},I={class:"detail"},T=L('<div class="group-head"><div class="group-first"><i class="bi bi-envelope-fill icon-envelope"></i><div class="name">หน่วยงาน</div></div></div><div class="line"></div>',2),q={class:"group-detail"},z={class:"group-between"},D={class:"group-input left"},O=e("div",{class:"name"},"ชื่อย่อ ",-1),j={class:"group-input"},G=e("div",{class:"name"},"หน่วยงาน",-1),H={class:"group-between"},J={class:"group-input left"},K=e("div",{class:"name"},"ส่งถึง (TO) ",-1),Q={class:"group-input"},R=e("div",{class:"name"},"สำเนาถึง (Cc) ",-1),W={class:"group-between"},X={class:"group-input"},Y=e("div",{class:"name"},"สำเนาลับถึง (Bcc)",-1),Z={class:"group-button"},$={class:"button-left"},ee=e("i",{class:"bi bi-arrow-clockwise icon-clockwise"},null,-1),te=e("div",{class:"button-right"},[e("button",{type:"submit",class:"button-search"},[e("i",{class:"bi bi-search icon-search"}),v(" ค้นหา ")])],-1),ae=e("div",{class:"line"},null,-1),se={class:"group-body"},oe={class:"table-master-mail-addresses"},le=e("thead",{class:"thead"},[e("tr",{class:"thead-row"},[e("th",{class:"col1"},"ลำดับ"),e("th",{class:"col2"},"หน่วยงาน"),e("th",{class:"col3"},"อีเมล์ติดต่อหน่วยงาน"),e("th",{class:"col4"},"เครื่องมือ")])],-1),de={class:"col1"},ne={class:"col2"},ie={class:"col3"},ce={class:"new-line"},re=e("div",{class:"name"},"ส่งถึง (TO)",-1),_e={class:"new-line"},he=e("div",{class:"name"},"สำเนาถึง (Cc)",-1),pe={class:"new-line"},ue=e("div",{class:"name"},"สำเนาลับถึง (Bcc)",-1),me={class:"col4"},ge={class:"group-icon"},be=["onClick"],ve=["onClick"],we=e("img",{src:S,alt:"times-circle",class:"icon-check-circle pointer"},null,-1),Ve=[we],fe=["onClick"],ye=e("img",{src:x,alt:"times-circle",class:"icon-times-circle"},null,-1),Pe=[ye],Ce={key:0,class:"tbody-row"},ke=e("td",{colspan:"4"},"ไม่มีข้อมูล",-1),Ae=[ke],Me={class:"group-footer"};function Ue(o,s,m,g,a,r){const d=c("cpn-input"),w=c("Form"),V=c("cpn-pagination"),f=c("cpn-modal-alert"),y=c("cpn-loading");return _(),h("div",F,[e("div",E,[e("div",I,[T,l(w,{onSubmit:r.apiMailAddress,onInvalidSubmit:o.onInvalidSubmit},{default:C(()=>[e("div",q,[e("div",z,[e("div",D,[O,l(d,{modelValue:a.data.short_name,"onUpdate:modelValue":s[0]||(s[0]=t=>a.data.short_name=t),name:"short_name",placeholder:"กรุณาระบุ"},null,8,["modelValue"])]),e("div",j,[G,l(d,{modelValue:a.data.department_name,"onUpdate:modelValue":s[1]||(s[1]=t=>a.data.department_name=t),name:"department_name",placeholder:"กรุณาระบุ"},null,8,["modelValue"])])]),e("div",H,[e("div",J,[K,l(d,{modelValue:a.data.to,"onUpdate:modelValue":s[2]||(s[2]=t=>a.data.to=t),name:"to",placeholder:"กรุณาระบุ"},null,8,["modelValue"])]),e("div",Q,[R,l(d,{modelValue:a.data.cc,"onUpdate:modelValue":s[3]||(s[3]=t=>a.data.cc=t),name:"cc",placeholder:"กรุณาระบุ"},null,8,["modelValue"])])]),e("div",W,[e("div",X,[Y,l(d,{modelValue:a.data.bcc,"onUpdate:modelValue":s[4]||(s[4]=t=>a.data.bcc=t),name:"bcc",placeholder:"กรุณาระบุ"},null,8,["modelValue"])])]),e("div",Z,[e("div",$,[e("button",{type:"button",class:"button-warning",onClick:s[5]||(s[5]=t=>r.cancelClick())},[ee,v(" ล้างการค้นหา ")])]),te])])]),_:1},8,["onSubmit","onInvalidSubmit"]),ae,e("div",se,[e("table",oe,[le,e("tbody",{class:k(["tbody",a.data.table.length>0?"tbody-top":""])},[(_(!0),h(A,null,M(a.data.table,(t,i)=>(_(),h("tr",{class:"tbody-row",key:i},[e("td",de,b(i+1+a.data.perPage*(a.data.page-1)),1),e("td",ne,b(t.department_name),1),e("td",ie,[e("div",ce,[re,l(d,{modelValue:t.to,"onUpdate:modelValue":n=>t.to=n,name:"to"+i,disabled:t.disabled},null,8,["modelValue","onUpdate:modelValue","name","disabled"])]),e("div",_e,[he,l(d,{modelValue:t.cc,"onUpdate:modelValue":n=>t.cc=n,name:"cc"+i,disabled:t.disabled},null,8,["modelValue","onUpdate:modelValue","name","disabled"])]),e("div",pe,[ue,l(d,{modelValue:t.bcc,"onUpdate:modelValue":n=>t.bcc=n,name:"bcc"+i,disabled:t.disabled},null,8,["modelValue","onUpdate:modelValue","name","disabled"])])]),e("td",me,[e("div",ge,[p(e("img",{onClick:n=>t.disabled=!1,src:B,alt:"",class:"icon-pencil pointer"},null,8,be),[[u,t.disabled]]),p(e("button",{onClick:n=>r.save(t),type:"button",class:"button-success"},Ve,8,ve),[[u,!t.disabled]]),p(e("button",{onClick:n=>t.disabled=!0,type:"button",class:"button-danger"},Pe,8,fe),[[u,!t.disabled]])])])]))),128)),a.data.table.length==0?(_(),h("tr",Ce,Ae)):U("",!0)],2)])]),e("div",Me,[l(V,{page:a.data.page,total:a.data.total,lastPage:a.data.lastPage,perPage:a.data.perPage,onPageChange:r.pageChange},null,8,["page","total","lastPage","perPage","onPageChange"])])])]),l(f,{modalAlert:a.modalAlert},null,8,["modalAlert"]),l(y,{show:a.showLoading},null,8,["show"])])}const xe=P(N,[["render",Ue]]);export{xe as default};
