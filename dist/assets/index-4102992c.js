import{_ as A,r as _,o as i,c as n,a as s,h as m,b as g,F as v,i as k,j as r,w as f,v as y,d as q,n as w,t as e,f as R,k as I}from"./index-6f9b4dc9.js";import{_ as D}from"./ballot-duotone-f2459825.js";import{_ as F}from"./plus-circle-duotone-64bd32fe.js";const j={name:"booking-out-inex",data(){return{modalAlert:{showModal:!1,title:"",message:""},showLoading:!1,optionSelectDefault:{regis_id:[],book_category_id:[]},data:{select:!1,search:"",table:[],page:1,total:0,lastPage:0,perPage:10,tag:"",as_of_date:"",book_category_id:""},modalRegiter:{showModal:!1,booking_register_details:[]}}},methods:{selectedAll(a){a.stopPropagation(),this.data.select=!this.data.select,this.data.table.filter(t=>{t.select=this.data.select})},selected(a,t){a.stopPropagation(),t.select=!t.select,this.data.select=this.data.table.every(h=>h.select)},addClick(){this.$router.push({name:"subministry-work.record-out-create"}).catch(()=>{})},editClick(a){this.$router.push({name:"subministry-work.record-out-edit",params:{id:a.id},query:{page:this.data.page,perPage:this.data.perPage}}).catch(()=>{})},pageChange(a){this.data.perPage=a.perPage,this.data.page=a.page,this.apirecordout()},search(){this.data.status=!0,this.data.perPage=10,this.data.page=1,this.data.tag="",this.apirecordout()},apirecordout(){this.data.table=[],this.showLoading=!0,this.axios.get("/booking-note",{params:{keyword:this.data.search,page_size:this.data.perPage,page:this.data.page,user_id:localStorage.getItem("user_id"),tag:this.data.tag}}).then(a=>{this.showLoading=!1,a.data.data&&(a.data.data.filter(t=>{this.data.total=t.total}),this.data.table=a.data.data,this.data.lastPage=Math.ceil(this.data.total/this.data.perPage))}).catch(a=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:a.response.data.message}})},async on_submit_modal(){let a={book_category_id:parseInt(this.data.book_category_id),user_id:parseInt(localStorage.getItem("user_id")),as_of_date:this.data.as_of_date};this.showLoading=!0,this.axios.post("/booking-note/quick",a).then(()=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"success",title:"สร้างบันทึกข้อความสำเร็จแล้ว",msgSuccess:!0,afterPressAgree(){location.reload()}}}).catch(t=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:t.response.data.message}}),this.modalRegiter.showModal=!1},modal_genno(){this.modalRegiter.showModal=!0,this.modalRegiter.booking_register_details=[{}]},api_master(){this.showLoading=!0;const a=this.axios.get("/master-data/book-category",{params:{book_type:1}});this.axios.all([a]).then(this.axios.spread((...t)=>{this.showLoading=!1;const h=t[0];h.data.data.filter(u=>(u.value=u.id,u.name=u.name,u)),this.optionSelectDefault.book_category_id=h.data.data,this.apirecordout()})).catch(t=>{this.showLoading=!1,this.modalAlert={showModal:!0,type:"error",title:"Error",message:t.response.data.message}})}},mounted(){var a,t;this.data.page=((a=this.$route.query)==null?void 0:a.page)||this.data.page,this.data.perPage=((t=this.$route.query)==null?void 0:t.perPage)||this.data.perPage,this.api_master()}},z={class:"record-out-inex"},E={class:"group-overflow"},N={class:"detail"},B={class:"group-head"},U={class:"group-first"},T={class:"d-flex justify-content-end"},G={class:"group-end"},H={class:"search"},J={class:"group-body"},K={class:"table-booking-out-inex"},O={class:"thead"},Q={class:"thead-row"},W={class:"col0"},X={class:"tbody"},Y=["onClick"],Z=["onClick"],$={key:0},ss={key:1},ts={class:"col1"},os={class:"col2"},es={class:"col3"},as={class:"col4"},ls={class:"col5"},ds={class:"col6"},is={class:"col7"},ns={class:"group-show"},rs={class:"span"},cs={key:0,class:"show-detail"},_s={class:"col8"},gs={class:"group-show date"},us={class:"span"},ps={class:"show-detail date"},hs={key:0},ms={key:1},bs={class:"col0"},vs={class:"col1"},ks={class:"col2"},fs={class:"group-show date"},ys={class:"span"},ws={class:"col3"},Ps={class:"col4"},Cs={class:"col5"},Ss={class:"col6"},Vs={class:"col7"},xs={class:"group-show"},Ls={class:"span"},Ms={key:0,class:"show-detail"},As={class:"col8"},qs={class:"group-show date"},Rs={class:"span"},Is={class:"show-detail date"},Ds={key:0},Fs={key:1},js={key:1},zs={key:0,class:"tbody-row"},Es={class:"group-footer"},Ns={class:"modal-register"},Bs={class:"modal-class"},Us={class:"modal-center"},Ts={class:"modal-size",ref:"modalRegiterref"},Gs={class:"modal-title"},Hs={class:"modal-detail"},Js={class:"detail-sub"},Ks={class:"group-between"},Os={class:"group-input"},Qs={class:"group-between"},Ws={class:"group-input"},Xs={class:"group-footer"};function Ys(a,t,h,u,l,c){const P=_("cpn-input"),C=_("cpn-pagination"),S=_("cpn-select"),V=_("cpn-datepicker"),x=_("Form"),L=_("cpn-modal-alert"),M=_("cpn-loading");return i(),n("div",z,[s("div",E,[s("div",N,[s("div",B,[s("div",U,[t[11]||(t[11]=s("img",{src:D,alt:"",class:"icon-users-cog"},null,-1)),t[12]||(t[12]=s("div",{class:"name"},"บันทึกส่งออก",-1)),s("button",{type:"button",class:"add-booking-out",onClick:t[0]||(t[0]=o=>c.addClick())},t[10]||(t[10]=[s("div",{class:"group-image"},[s("img",{src:F,alt:"",class:"icon-plus"}),m(" สร้างบันทึกส่งออก ")],-1)])),s("div",T,[s("button",{type:"button",class:"add-booking-out",onClick:t[1]||(t[1]=o=>c.modal_genno())}," ออกเลขบันทึกภายใน ")])]),s("div",G,[s("div",H,[g(P,{modelValue:l.data.search,"onUpdate:modelValue":t[2]||(t[2]=o=>l.data.search=o),name:"search",type:"text",searchFlag:!0,onSearchClick:t[3]||(t[3]=o=>c.search()),placeholder:"เลขที่หนังสือออก/ชื่อเรื่อง/Tag"},null,8,["modelValue"])])])]),t[26]||(t[26]=s("div",{class:"line"},null,-1)),s("div",J,[s("table",K,[s("thead",O,[s("tr",Q,[s("th",W,[s("button",{onClick:t[4]||(t[4]=o=>c.selectedAll(o))},t[13]||(t[13]=[s("i",{class:"bi bi-plus-lg"},null,-1)]))]),t[14]||(t[14]=s("th",{class:"col1"},"ความเร่งด่วน",-1)),t[15]||(t[15]=s("th",{class:"col2"},"เลขบันทึกภายใน",-1)),t[16]||(t[16]=s("th",{class:"col3"},"ชื่อเรื่อง",-1)),t[17]||(t[17]=s("th",{class:"col4"},"หน่วยงานปลายทาง",-1)),t[18]||(t[18]=s("th",{class:"col5"},"ลงวันที่",-1)),t[19]||(t[19]=s("th",{class:"col6"},"ชนิด",-1)),t[20]||(t[20]=s("th",{class:"col7"},"ผู้รับผิดชอบ",-1)),t[21]||(t[21]=s("th",{class:"col8"},"สถานะ",-1))])]),s("tbody",X,[(i(!0),n(v,null,k(l.data.table,(o,p)=>(i(),n(v,{key:p},[s("tr",{class:w(["tbody-row pointer",p%2!=0?"color-tr1":"color-tr2"]),onClick:d=>c.editClick(o)},[s("td",{class:"col0",onClick:d=>o.booking_follows.length>1?c.selected(d,o):""},[o.select&&o.booking_follows.length>1?(i(),n("button",$,t[22]||(t[22]=[s("i",{class:"bi bi-dash-lg"},null,-1)]))):r("",!0),!o.select&&o.booking_follows.length>1?(i(),n("button",ss,t[23]||(t[23]=[s("i",{class:"bi bi-plus-lg"},null,-1)]))):r("",!0)],8,Z),s("td",ts,e(o.speed_name),1),s("td",os,e(o.booking_note_number),1),s("td",es,e(o.subject),1),s("td",as,e(o.booking_follows.length>1?o.booking_follows.length:o.department_name),1),s("td",ls,e(o.as_of_date),1),s("td",ds,e(o.book_type),1),s("td",is,[s("div",ns,[s("span",rs,e(o.response_name),1),o.response_name?(i(),n("div",cs,e(o.response_name),1)):r("",!0)])]),s("td",_s,[s("div",gs,[s("span",us,e(o.status_name),1),s("div",ps,[o.receive_date?(i(),n("div",hs," วันที่รับเข้า: "+e(o.receive_date),1)):r("",!0),o.created_at?(i(),n("div",ms," วันที่ส่งออก: "+e(o.created_at),1)):r("",!0)])])])],10,Y),o.select&&o.booking_follows.length>1?(i(!0),n(v,{key:0},k(o.booking_follows,(d,b)=>(i(),n("tr",{key:b,class:w(["tbody-row",p%2!=0?b%2!=0?"color-tr1":"color-tr2":b%2!=0?"color-tr2":"color-tr1"])},[s("td",bs,e(),1),s("td",vs,e(b+1),1),s("td",ks,[m(e()+" ",1),s("div",fs,[s("span",ys,e(d.department_name),1)])]),s("td",ws,e(d.subject),1),s("td",Ps,e(),1),s("td",Cs,e(d.as_of_date),1),s("td",Ss,e(d.book_type),1),s("td",Vs,[s("div",xs,[s("span",Ls,e(d.creater_name),1),d.creater_name?(i(),n("div",Ms,e(d.creater_name),1)):r("",!0)])]),s("td",As,[m(e()+" ",1),s("div",qs,[s("span",Rs,e(d.status_name),1),s("div",Is,[d.receive_date?(i(),n("div",Ds," วันที่รับเข้า: "+e(d.receive_date),1)):r("",!0),d.created_at?(i(),n("div",Fs," วันที่ส่งออก: "+e(d.created_at),1)):r("",!0)])])])],2))),128)):r("",!0),o.select&&o.booking_follows.length>1?(i(),n("tr",js,t[24]||(t[24]=[s("td",{colspan:"9",style:{"border-bottom":"solid 1px #c1cfe3"}},null,-1)]))):r("",!0)],64))),128)),l.data.table.length==0?(i(),n("tr",zs,t[25]||(t[25]=[s("td",{colspan:"9"},"ไม่มีข้อมูล",-1)]))):r("",!0)])])]),s("div",Es,[g(C,{page:l.data.page,total:l.data.total,lastPage:l.data.lastPage,perPage:l.data.perPage,onPageChange:c.pageChange},null,8,["page","total","lastPage","perPage","onPageChange"])])])]),f(s("div",Ns,[s("div",Bs,[s("div",Us,[s("div",Ts,[g(x,{onSubmit:c.on_submit_modal,onInvalidSubmit:a.onInvalidSubmit},{default:q(()=>[s("div",Gs,[t[27]||(t[27]=s("div",{class:"title-size"},"ออกเลขบันทึกภายใน",-1)),s("i",{class:"bi bi-x-lg icon-close",onClick:t[5]||(t[5]=o=>l.modalRegiter.showModal=!1)})]),t[32]||(t[32]=s("div",{class:"line"},null,-1)),s("div",Hs,[(i(!0),n(v,null,k(l.modalRegiter.booking_register_details,(o,p)=>(i(),n("div",{class:"message",key:p},[s("div",Js,[s("div",Ks,[s("div",Os,[t[28]||(t[28]=s("div",{class:"name"},[m("ทะเบียนบันทึกข้อความ "),s("span",{class:"required"},"*")],-1)),g(S,{modelValue:l.data.book_category_id,"onUpdate:modelValue":t[6]||(t[6]=d=>l.data.book_category_id=d),name:"book_category_id",rules:"required",optionSelect:l.optionSelectDefault.book_category_id},null,8,["modelValue","optionSelect"])])]),s("div",Qs,[s("div",Ws,[t[29]||(t[29]=s("div",{class:"name"},[m("ลงวันที่ "),s("span",{class:"required"},"*")],-1)),g(V,{modelValue:l.data.as_of_date,"onUpdate:modelValue":t[7]||(t[7]=d=>l.data.as_of_date=d),rules:"required",name:`addregis_date${p}`},null,8,["modelValue","name"])])])])]))),128))]),t[33]||(t[33]=s("div",{class:"line"},null,-1)),s("div",Xs,[s("button",{type:"button",onClick:t[8]||(t[8]=o=>l.modalRegiter.showModal=!1),class:"btn button-danger"},t[30]||(t[30]=[s("div",{class:"group-name"},[s("img",{src:R,alt:"times-circle",class:"image-icon"}),s("div",{class:"name"},"ยกเลิก")],-1)])),f(s("button",{type:"submit",class:"btn button-success",onClick:t[9]||(t[9]=o=>a.flagSave=3)},t[31]||(t[31]=[s("div",{class:"group-name"},[s("img",{src:I,alt:"times-circle",class:"image-icon"}),s("div",{class:"name"},"ตกลง")],-1)]),512),[[y,!l.data.booking_note_number]])])]),_:1},8,["onSubmit","onInvalidSubmit"])],512)])])],512),[[y,l.modalRegiter.showModal]]),g(L,{modalAlert:l.modalAlert},null,8,["modalAlert"]),g(M,{show:l.showLoading},null,8,["show"])])}const tt=A(j,[["render",Ys]]);export{tt as default};
